{"version":3,"file":"thunderEvents.min.mjs","sources":["../lib/constants.js","../lib/utilities.js","../lib/state.js","../lib/exports.js","../lib/uiComponents/ProgramGuideNative/getStyles.js","../lib/uiComponents/ProgramGuideNative/componentUtils.js","../lib/uiComponents/ProgramGuideNative/renderSortDialog.js","../lib/uiComponents/ProgramGuideNative/renderEventDialog.js","../lib/uiComponents/ProgramGuideNative/renderByLocation.js","../lib/uiComponents/ProgramGuideNative/renderByTime.js","../lib/uiComponents/ProgramGuideNative/renderFavorites.js","../lib/uiComponents/ProgramGuideNative/renderSearchResults.js","../node_modules/dialog-polyfill/dist/dialog-polyfill.esm.js","../lib/uiComponents/ProgramGuideNative/index.js","../lib/uiComponents/ProgramGuideNative/renderSearchBar.js","../src/index.js"],"sourcesContent":["export const DEFAULT_FLOOR_PLAN = {\r\n  title: 'Venue',\r\n  imageSrc: '',\r\n  clickableAreas: [],\r\n}\r\n\r\nexport const DEFAULT_GUIDE = {\r\n  events: [],\r\n  floorPlan: DEFAULT_FLOOR_PLAN,\r\n}\r\n\r\nconst FAVORITES_KEY = 'FAVORITE_EVENTS'\r\n\r\nexport const DEFAULT_ADD_FAVORITE = async event => {\r\n  const favoriteEvents = JSON.parse(localStorage.getItem(FAVORITES_KEY) || '[]')\r\n  favoriteEvents.push(event)\r\n  const eventsJSON = JSON.stringify(favoriteEvents)\r\n  localStorage.setItem(FAVORITES_KEY, eventsJSON)\r\n  return favoriteEvents\r\n}\r\n\r\nexport const DEFAULT_REMOVE_FAVORITE = async event => {\r\n  const favoriteEvents = JSON.parse(localStorage.getItem(FAVORITES_KEY) || '[]')\r\n  const removeIndex = favoriteEvents.findIndex(({ location: _location, start, name }) => {\r\n    const { location: cLocation, start: cStart, name: cName } = event\r\n    return _location === cLocation && start === cStart && name === cName\r\n  })\r\n  favoriteEvents.splice(removeIndex, 1)\r\n  const eventsJSON = JSON.stringify(favoriteEvents)\r\n  localStorage.setItem(FAVORITES_KEY, eventsJSON)\r\n  return favoriteEvents\r\n}\r\n\r\nexport const DEFAULT_GET_FAVORITES = async () => {\r\n  const favoriteEvents = JSON.parse(localStorage.getItem(FAVORITES_KEY) || '[]')\r\n  return favoriteEvents\r\n}\r\n\r\nexport const DEFAULT_FETCH_DATA = () => Promise.resolve({\r\n  guide: DEFAULT_GUIDE,\r\n  addFavorite: DEFAULT_ADD_FAVORITE,\r\n  getFavorites: DEFAULT_GET_FAVORITES,\r\n})\r\n\r\nconst NOW = Date.now() // date in milliseconds\r\n\r\nconst HOUR = 1000 * 60 * 60 // milliseconds * seconds * minutes\r\n\r\nexport const DEFAULT_EVENT = {\r\n  start: NOW,\r\n  end: NOW + HOUR,\r\n  location: '(not provided)',\r\n  name: '(no name)',\r\n  host: '(not provided)',\r\n  category: '(not provided)',\r\n  description: '(no description)',\r\n}\r\n\r\nexport const DEFAULT_CLICKABLE_AREA = {\r\n  shape: 'rect',\r\n  coords: [],\r\n  href: '#',\r\n  alt: '',\r\n}\r\n\r\nexport const DEFAULT_TIMES = {\r\n  days: [],\r\n  interval: 60,\r\n}\r\n\r\nexport const DEFAULT_BREAKPOINT = '50em'\r\n\r\nexport const NOOP = () => {}\r\n","import { NOOP } from './constants'\r\n\r\nexport const getType = val => {\r\n  if (val === null) return 'null'\r\n  if (typeof val === 'object') return val.constructor.name.toLowerCase()\r\n  return typeof val\r\n}\r\n\r\nexport const checkType = (val, type) => {\r\n  const validString = getType(type) === 'string'\r\n  const validArray = getType(type) === 'array' && type.every(t => getType(t) === 'string')\r\n  if (!validString && !validArray) throw '`checkType()` expects either a string or array of strings in the second argument'\r\n  if (validString) return getType(val) === type\r\n  if (validArray) return type.some(t => getType(val) === t)\r\n}\r\n\r\nexport const isObject = obj => checkType(obj, 'object')\r\n\r\nexport const isEmpty = val => checkType(val, ['undefined', 'null'])\r\n\r\nexport const contains = (val, search) => {\r\n  const valIsString = checkType(val, 'string')\r\n  const valIsArray = checkType(val, 'array') && val.every(t => checkType(t, 'string'))\r\n  const validSearch = checkType(search, ['string', 'regexp'])\r\n  if (!valIsArray && !valIsString) throw '`contains()` expects either a string or array of strings in the first argument'\r\n  if (!validSearch) throw '`contains()` expects either a string or regular expression in the second argument'\r\n  if (valIsArray) return val.some(v => v.search(search) !== -1)\r\n  if (valIsString) return val.search(search) !== -1\r\n}\r\n\r\n/**\r\n * Returns a function which gets a field from a given object, unless it's empty,\r\n * in which case it gets that same field from a fallback object.\r\n * @param {object} fallbackObj - The object to be referenced when a field is empty on the original object.\r\n * @param {function} onFallback - An optional callback to run when the fallback is used.\r\n * @param {object} _altTypes - A mapping of fields to acceptable alternative types.\r\n * @returns {function} - Used to get the value from a provided key.\r\n */\r\nexport const useFallback = (fallbackObj, onFallback = NOOP, _altTypes = {}) => {\r\n  if (!isObject(fallbackObj)) throw '`useFallback()` expects an object in the first argument'\r\n  if (!checkType(onFallback, 'function')) throw '`useFallback()` expects a function in the second argument'\r\n  if (!isObject(_altTypes)) throw '`useFallback()` expects an object in the third argument'\r\n  return (obj, key) => {\r\n    const fallbackValue = fallbackObj[key]\r\n    const valid = isObject(obj)\r\n    const value = valid ? obj[key] : null\r\n    const empty = isEmpty(value)\r\n    const type = getType(value)\r\n    const altTypes = _altTypes[key]\r\n    const altTypesArr = checkType(altTypes, 'array') ? altTypes : (checkType(altTypes, 'string') ? [altTypes] : [])\r\n    const mismatch = type !== getType(fallbackValue) && !altTypesArr.some(t => t === type)\r\n    if (!valid || empty || mismatch) {\r\n      const status = !valid ? 'invalid' : (empty ? 'empty' : 'mismatch')\r\n      onFallback(status, key)\r\n      return fallbackValue\r\n    }\r\n    return value\r\n  }\r\n}\r\n\r\n/**\r\n * Returns a function which casts any value to the same structure as the provided object (the type).\r\n * @param {object} type - An object which serves as the (shallow) structure constraints.\r\n * @param {string} name - The optional name of the type for logging purposes.\r\n * @param {object} altTypes - A mapping of fields to acceptable alternative types.\r\n * @returns {function} - Used to cast a provided value to the given type.\r\n */\r\nexport const useCast = (type, name = 'object', altTypes = {}) => {\r\n  if (!isObject(type)) throw 'You may only cast to custom object types'\r\n  return obj => {\r\n    if (!isObject(obj)) return type\r\n    const getValue = useFallback(type, (status, key) => {\r\n      if (status === 'invalid') console.warn(`The provided ${name} is not a valid object.`)\r\n      else if (status === 'mismatch') console.warn(`The \\`${key}\\` field expected type \\`${getType(type[key])}\\` but got \\`${getType(obj[key])}\\`.`)\r\n      else if (status === 'empty') console.warn(`The provided ${name} did not have the \\`${key}\\` field.`)\r\n    }, altTypes)\r\n    return Object.keys(type).reduce((castObj, key) => {\r\n      castObj[key] = getValue(obj, key)\r\n      return castObj\r\n    }, {})\r\n  }\r\n}\r\n\r\nexport const checkFilterType = (filter = {}) => {\r\n  if ('after' in filter && !checkType(filter.after, ['number', 'date'])) throw 'The `after` field expects a number or date'\r\n  if ('before' in filter && !checkType(filter.before, ['number', 'date'])) throw 'The `before` field expects a number or date'\r\n  if ('locations' in filter && !checkType(filter.locations, 'array')) throw 'The `locations` field expects an array'\r\n  if ('search' in filter && !checkType(filter.search, ['string', 'regexp'])) throw 'The `search` field expects a string or regular expression'\r\n  return true // indicate success\r\n}\r\n\r\n/**\r\n * This is the most efficient way to clear HTML, much faster than innerHTML.\r\n * @param {HTMLElement} element - the DOM element we want to empty\r\n */\r\nexport const clearHTML = element => {\r\n  let i = element.childNodes.length\r\n  while (i--) { element.removeChild(element.lastChild) }\r\n}\r\n\r\n/**\r\n * This is the most efficient way to parse HTML, much faster than innerHTML.\r\n *\r\n * @param {string} htmlStr - a string containing only raw HTML\r\n */\r\nexport const parseHTML = htmlStr => {\r\n  const range = document.createRange()\r\n  range.selectNode(document.body) // required in Safari\r\n  return range.createContextualFragment(htmlStr)\r\n}\r\n\r\n/**\r\n * This helps us avoid trailing commas when mapping template literals.\r\n * @param {Array} arr - the array to iterate\r\n * @param {function} callback - the callback for each iteration; should return a string or stringifiable value\r\n */\r\nexport const mapString = (arr, callback) => arr.map(callback).join('')\r\n\r\n/**\r\n * Rounds a date to the nearest given minute\r\n * @param {Date|number|string} _date - The date to round (or anything that can be parsed as a date)\r\n * @param {number} nearestMinute - The nearest minute to round to (15 by default)\r\n */\r\nexport const roundMinutes = (_date, nearestMinute = 15) => {\r\n  const date = new Date(_date)\r\n  const roundedMinutes = Math.round(date.getMinutes() / nearestMinute) * nearestMinute\r\n  date.setMinutes(roundedMinutes)\r\n  return date\r\n}\r\n\r\nexport const WholeNumber = num => Number(num.toFixed())\r\n\r\n/**\r\n * Gets the name of the day based on the index (typically returned by `date.getDay()`)\r\n * @param {number} idx - The index of the day of the week\r\n * @param {boolean} short - Whether to abbreviate the day names or not\r\n * @returns {string} - The name of the day of the week\r\n */\r\nexport const getDay = (idx, short = false) => {\r\n  const days = [\r\n    'Sunday',\r\n    'Monday',\r\n    'Tuesday',\r\n    'Wednesday',\r\n    'Thursday',\r\n    'Friday',\r\n    'Saturday',\r\n  ]\r\n  const shortDays = [\r\n    'Sun',\r\n    'Mon',\r\n    'Tues',\r\n    'Wed',\r\n    'Thurs',\r\n    'Fri',\r\n    'Sat',\r\n  ]\r\n  return short ? shortDays[idx] : days[idx]\r\n}\r\n\r\nexport const getDateInfo = _date => {\r\n  const date = new Date(_date)\r\n  return {\r\n    time: date.toLocaleTimeString('en-US', { timeStyle: 'short' }),\r\n    day: getDay(date.getDay()),\r\n    date: date.toLocaleDateString(),\r\n  }\r\n}\r\n\r\n/**\r\n * Generates a string representing javascript, which can be used in the\r\n * HTML templates of native web components.\r\n * \r\n * EXAMPLE:\r\n * ```js\r\n *   const open = true\r\n *   const html = `<button onclick=\"this.getRootNode().host.openDialog(${open})\">Click me</button>`\r\n * ```\r\n * \r\n * versus\r\n * \r\n * ```js\r\n *   const open = true\r\n *   const html = `<button onclick=\"${runMethod('openDialog', open)}\">Click me</button>`\r\n * ```\r\n * \r\n * @param {string} name - The name of the component method to run\r\n * @param {...*} args - The arguments to be used in the function call (objects will be converted to JSON and encoded as a URI component)\r\n * @returns {string} - A string representing JavaScript code\r\n */\r\nexport const runMethod = (name, ...args) => `this.getRootNode().host.${name}(${args.length ? `\r\n  ${[...args].map(a => getType(a) === 'object'\r\n    ? `\\`${encodeURIComponent(JSON.stringify(a))}\\`` // stringify objects to avoid [object Object] and encode to avoid double quote conflicts\r\n    : (getType(a) === 'string' ? `\\`${a}\\`` : String(a)) ) // wrap strings in quotes and send all other types without quotes\r\n  }\r\n` : 'event'})`\r\n\r\nexport const getEventId = ({ location, name, start: _start }) => {\r\n  const snip = s => s.replace(/[^a-zA-Z0-9]/g, '')\r\n  const date = new Date(_start)\r\n  const start = `${date.toLocaleDateString()}-${date.toLocaleTimeString()}`\r\n  return `${snip(location)}-${snip(name)}-${snip(start)}`\r\n}\r\n\r\nexport const search = (_input, _text) => {\r\n\r\n  // * replace variation characters (for example, é becomes e)\r\n  // * remove anything that isn't alphanumeric (including spaces)\r\n  //     ^ this lets \"megaman\" match \"mega man\"\r\n  // * use lower case for case-insensitive search\r\n  const formatForSimilarMatch = str => str\r\n    ?.normalize('NFD')\r\n    .replace(/\\p{Diacritic}/gu, '')\r\n    .replace(/[^a-zA-Z0-9]/g, '')\r\n    .toLowerCase()\r\n\r\n  // first try matching the entire query\r\n  const input = formatForSimilarMatch(_input)\r\n  const text = formatForSimilarMatch(_text)\r\n  if (text.search(input) !== -1) return true\r\n  if (input.search(text) !== -1) return true\r\n\r\n  // if that fails, try each word\r\n  return _input.split(/\\s+/g).some(input =>\r\n    text.search(formatForSimilarMatch(input)) !== -1)\r\n}\r\n\r\nexport const trim = str => str.length > 40 ? str.slice(0, 36) + '...' : str\r\n","import { DEFAULT_ADD_FAVORITE, DEFAULT_REMOVE_FAVORITE, DEFAULT_GET_FAVORITES, DEFAULT_GUIDE } from './constants'\r\nimport { checkType, roundMinutes, getDay } from './utilities'\r\n\r\nexport const state = {\r\n\r\n  // utilities for synchronous actions after loading state\r\n  _hasFetched: false,\r\n  get hasFetched() { return this._hasFetched },\r\n  set hasFetched(bool) {\r\n    this._hasFetched = bool\r\n    if (bool === false) return false\r\n    this.fetchQueue.forEach(resolve => resolve())\r\n    return true\r\n  },\r\n  fetchQueue: [],\r\n  waitForFetch() {\r\n    return new Promise(resolve => {\r\n      if (this.hasFetched) resolve()\r\n      else this.fetchQueue.push(resolve)\r\n    })\r\n  },\r\n\r\n  // default guide\r\n  guide: DEFAULT_GUIDE,\r\n\r\n  // default favorite functionality\r\n  addFavorite: DEFAULT_ADD_FAVORITE,\r\n  removeFavorite: DEFAULT_REMOVE_FAVORITE,\r\n  getFavorites: DEFAULT_GET_FAVORITES,\r\n\r\n  // get locations from events dynamically\r\n  get locations() {\r\n    const events = this.guide?.events || []\r\n    return [...events.reduce((locations, event) => {\r\n      if (!checkType(event, 'object')) return locations\r\n      if (!checkType(event.location, 'string')) return locations\r\n      locations.add(event.location)\r\n      return locations\r\n    }, new Set())]\r\n  },\r\n\r\n  // get times from events dynamically\r\n  get times() {\r\n    const events = this.guide?.events || []\r\n    const allTimes = [...events.reduce((times, event) => {\r\n      if (!checkType(event, 'object')) return times\r\n      if (!checkType(event.start, ['number', 'date'])) return times\r\n      if (!checkType(event.end, ['number', 'date'])) return times\r\n      times.add(roundMinutes(event.start))\r\n      times.add(roundMinutes(event.end))\r\n      return times\r\n    }, new Set())]\r\n    const earliestTime = new Date(Math.min(...allTimes))\r\n    const latestTime = new Date(Math.max(...allTimes))\r\n    const interval = allTimes.reduce((interval, date) => {\r\n      if (interval !== 15) {\r\n        const minutes = date.getMinutes()\r\n        if (minutes === 30) interval = 30\r\n        if (minutes === 15 || minutes === 45) interval = 15\r\n      }\r\n      return interval\r\n    }, 0)\r\n    const getTimeObject = date => ({\r\n      date,\r\n      timeString: date.toLocaleTimeString('en-US', { timeStyle: 'short' }),\r\n    })\r\n    const getFullDay = time => `${getDay(time.getDay())} ${time.toLocaleDateString()}`\r\n    let days = { [getFullDay(earliestTime)]: [getTimeObject(earliestTime)] }\r\n    let prevTime = earliestTime\r\n    while (prevTime < latestTime) {\r\n      const lastTimeInDay = Math.max(...allTimes.filter(t => t.getDate() === prevTime.getDate()))\r\n      let currentTime = null\r\n      if (lastTimeInDay === Number(prevTime)) {\r\n        currentTime = new Date(allTimes.find(time => time > prevTime))\r\n        days[getFullDay(currentTime)] = [getTimeObject(currentTime)]\r\n      } else {\r\n        currentTime = new Date(prevTime)\r\n        currentTime.setMinutes(currentTime.getMinutes() + interval)\r\n        days[getFullDay(currentTime)].push(getTimeObject(currentTime))\r\n      }\r\n      prevTime = currentTime\r\n    }\r\n    return {\r\n      days,\r\n      interval,\r\n    }\r\n  },\r\n}\r\n","import {\r\n  DEFAULT_FETCH_DATA,\r\n  DEFAULT_EVENT,\r\n  DEFAULT_FLOOR_PLAN,\r\n  DEFAULT_CLICKABLE_AREA,\r\n} from './constants'\r\nimport {\r\n  useCast,\r\n  checkType,\r\n  checkFilterType,\r\n  isObject,\r\n} from './utilities'\r\nimport { state } from './state'\r\n\r\nconst init = async (init = DEFAULT_FETCH_DATA) => {\r\n  const data = await init()\r\n  const { guide } = data\r\n  if (!isObject(data)) throw '`init()` must return an object'\r\n  if (!isObject(guide)) throw 'The `guide` field expects an object'\r\n  if ('events' in guide) {\r\n    if (!checkType(guide.events, 'array')) throw 'The `guide.events` field expects an array'\r\n    const castEvent = useCast(DEFAULT_EVENT, 'event', { start: 'date', end: 'date' })\r\n    state.guide.events = guide.events.map(castEvent)\r\n  }\r\n  if ('floorPlan' in guide) {\r\n    if (!isObject(guide.floorPlan)) throw 'The `guide.floorPlan` field expects an object'\r\n    const castFloorPlan = useCast(DEFAULT_FLOOR_PLAN, 'floor plan')\r\n    const castClickableArea = useCast(DEFAULT_CLICKABLE_AREA, 'clickable area')\r\n    const floorPlan = castFloorPlan(guide.floorPlan)\r\n    state.guide.floorPlan = {\r\n      ...floorPlan,\r\n      clickableAreas: floorPlan.clickableAreas.map(castClickableArea),\r\n    }\r\n  }\r\n  if ('addFavorite' in data) {\r\n    if (!checkType(data.addFavorite, 'function')) throw 'The `addFavorite` field expects a function'\r\n    state.addFavorite = data.addFavorite\r\n  }\r\n  if ('removeFavorite' in data) {\r\n    if (!checkType(data.removeFavorite, 'function')) throw 'The `removeFavorite` field expects a function'\r\n    state.removeFavorite = data.removeFavorite\r\n  }\r\n  if ('getFavorites' in data) {\r\n    if (!checkType(data.getFavorites, 'function')) throw 'The `getFavorites` field expects a function'\r\n    state.getFavorites = data.getFavorites\r\n  }\r\n  state.hasFetched = true\r\n}\r\n\r\nconst getEvents = async (_filters = {}) => {\r\n  await state.waitForFetch()\r\n  if (!isObject(_filters)) throw '`getEvents()` expects an object in the first argument'\r\n  const { include: _include = {}, exclude: _exclude = {} } = _filters\r\n  checkFilterType(_include) // throws if invalid\r\n  checkFilterType(_exclude) // throws if invalid\r\n  const filters = {\r\n    ..._filters,\r\n    include: {\r\n      ..._include,\r\n      after: _include.after ? Number(_include.after) : 0,\r\n      before: _include.before ? Number(_include.before) : Infinity,\r\n    },\r\n    exclude: {\r\n      ..._exclude,\r\n      after: _exclude.after ? Number(_exclude.after) : Infinity,\r\n      before: _exclude.before ? Number(_exclude.before) : 0,\r\n    },\r\n  }\r\n  const { include = {}, exclude = {} } = filters\r\n  return state.guide.events.filter(event => {\r\n    \r\n    // filter within time range\r\n    if (event.start < include.after) return false\r\n    if (event.start > exclude.after) return false\r\n    if (event.end > include.before) return false\r\n    if (event.end < exclude.before) return false\r\n    \r\n    // filter by location\r\n    if ('locations' in include && !contains(include.locations, event.location)) return false\r\n    if ('locations' in exclude && contains(exclude.locations, event.location)) return false\r\n    \r\n    // filter by name\r\n    if ('search' in include && !contains(event.name, include.search)) return false\r\n    if ('search' in exclude && contains(event.name, exclude.search)) return false\r\n\r\n    // if all previous checks pass, keep this event in the array\r\n    return true\r\n  })\r\n}\r\n\r\nconst getLocations = async () => {\r\n  await state.waitForFetch()\r\n  return state.locations\r\n}\r\n\r\nconst getTimes = async () => {\r\n  await state.waitForFetch()\r\n  return state.times\r\n}\r\n\r\nconst getFloorPlan = async () => {\r\n  await waitForFetch()\r\n  return state.guide.floorPlan\r\n}\r\n\r\nconst addFavorite = async event => {\r\n  const favorites = await state.addFavorite(event)\r\n  return favorites\r\n}\r\n\r\nconst removeFavorite = async event => {\r\n  const favorites = await state.removeFavorite(event)\r\n  return favorites\r\n}\r\n\r\nconst getFavorites = async () => {\r\n  const favorites = await state.getFavorites()\r\n  return favorites\r\n}\r\n\r\nexport {\r\n  init,\r\n  addFavorite,\r\n  removeFavorite,\r\n  getFavorites,\r\n  getEvents,\r\n  getLocations,\r\n  getTimes,\r\n  getFloorPlan,\r\n}\r\n","export const getStyles = breakpoint => /* css */`\r\n  :host {\r\n\r\n    /* general fonts */\r\n    --font: inherit;\r\n    --font-secondary: var(--font);\r\n\r\n    /* specific fonts */\r\n    --font-header: var(--font);\r\n    --font-content: var(--font-secondary);\r\n    --font-column-header: var(--font-header);\r\n    --font-row-header: var(--font-header);\r\n\r\n    /* padding */\r\n    --padding-cell: 1rem 2rem;\r\n    --padding-header: var(--padding-cell);\r\n    --padding-column-header: var(--padding-header);\r\n    --padding-row-header: var(--padding-header);\r\n\r\n    /* general colors */\r\n    --color-primary: lightsteelblue;\r\n    --color-primary-contrast: black;\r\n    --color-secondary: steelblue;\r\n    --color-secondary-contrast: white;\r\n    --color-tertiary: midnightblue;\r\n\r\n    /* specific colors */\r\n    --color-background: var(--color-tertiary);\r\n    --color-cell: var(--color-primary);\r\n    --color-empty: transparent;\r\n    --color-content: var(--color-primary-contrast);\r\n    --color-header: var(--color-secondary);\r\n    --color-header-content: var(--color-secondary-contrast);\r\n    --color-column-header: var(--color-header);\r\n    --color-column-header-content: var(--color-header-content);\r\n    --color-row-header: var(--color-header);\r\n    --color-row-header-content: var(--color-header-content);\r\n    --color-corner: var(--color-header);\r\n    --color-corner-content: var(--color-header-content);\r\n  }\r\n\r\n  /* remove browser defaults so fonts can be fully customized */\r\n  :host, button, input {\r\n    font-family: var(--font-secondary);\r\n    font-size: inherit;\r\n  }\r\n\r\n  .pg-search-bar {\r\n    background-color: var(--color-background);\r\n    display: grid;\r\n    gap: 0.2rem;\r\n    grid-template-columns: 1fr auto;\r\n    margin: 0;\r\n    padding: 0.2rem 0.2rem 0;\r\n  }\r\n  .pg-search-icon {\r\n    border: 0.2rem solid;\r\n    border-radius: 50%;\r\n    display: block;\r\n    height: 0.8rem;\r\n    position: relative;\r\n    transform: translate(-0.15rem, -0.1rem);\r\n    width: 0.8rem;\r\n  }\r\n  .pg-search-icon:after {\r\n    background-color: var(--color-content);\r\n    bottom: -0.2rem;\r\n    content: '';\r\n    display: block;\r\n    height: 0.2rem;\r\n    width: 0.5rem;\r\n    position: absolute;\r\n    right: -0.4rem;\r\n    transform: rotate(45deg);\r\n  }\r\n  .pg-table-wrapper {\r\n    overflow: auto;\r\n    max-width: 100%;\r\n    margin-bottom: 1rem;\r\n    position: relative;\r\n  }\r\n  .pg-table {\r\n    background-color: var(--color-background);\r\n    width: 100%;\r\n  }\r\n  .pg-cell-wrapper {\r\n    background-color: var(--color-cell);\r\n    font-family: var(--font-content);\r\n    padding: var(--padding-cell);\r\n    position: relative;\r\n    text-align: center;\r\n  }\r\n  .pg-cell-wrapper--overflow:before {\r\n    content: '\\\\2039';\r\n    font-size: 2.5rem;\r\n    position: absolute;\r\n    left: 0;\r\n    top: 0;\r\n    bottom: 0;\r\n    margin: auto;\r\n    line-height: 2.5rem;\r\n  }\r\n  .pg-cell-wrapper--corner {\r\n    background-color: var(--color-corner);\r\n    color: var(--color-corner-content);\r\n    cursor: pointer;\r\n  }\r\n  .pg-cell-wrapper--row-header {\r\n    background-color: var(--color-row-header);\r\n    color: var(--color-row-header-content);\r\n    font-family: var(--font-row-header);\r\n    padding: var(--padding-row-header);\r\n    text-align: right;\r\n  }\r\n  .pg-cell-wrapper--row-header,\r\n  .pg-cell-wrapper--corner {\r\n    border-right: 0.1rem solid var(--color-background);\r\n    left: 0;\r\n    position: sticky;\r\n    width: 0; /* columns size to the minimum width */\r\n    z-index: 1;\r\n  }\r\n  .pg-cell--corner,\r\n  .pg-cell--row-header {\r\n    width: 9rem;\r\n  }\r\n  .pg-cell--row-header {\r\n    pointer-events: none;\r\n    user-select: none;\r\n  }\r\n  .pg-cell--data {\r\n    position: sticky;\r\n    left: 14rem;\r\n    margin: auto;\r\n    width: fit-content;\r\n    z-index: 0;\r\n  }\r\n  .pg-cell--data-search,\r\n  .pg-cell--data-favorite {\r\n    display: grid;\r\n    left: 0;\r\n    justify-content: center;\r\n    margin: auto;\r\n  }\r\n  .pg-search-result-name {\r\n    font-weight: bold;\r\n    padding-bottom: 0.8rem;\r\n  }\r\n  .pg-inline-text {\r\n    display: inline-block;\r\n  }\r\n  .pg-cell--corner {\r\n    align-items: center;\r\n    display: grid;\r\n    gap: 0.5rem;\r\n    grid-template-columns: auto auto;\r\n    justify-content: center;\r\n    margin: auto;\r\n  }\r\n  .pg-cell-wrapper--column-header {\r\n    background-color: var(--color-column-header);\r\n    color: var(--color-column-header-content);\r\n    font-family: var(--font-column-header);\r\n    padding: var(--padding-column-header);\r\n  }\r\n  .pg-cell-wrapper--column-header-active-time {\r\n    display: grid;\r\n    filter: brightness(1.3);\r\n    gap: 0;\r\n  }\r\n  .pg-cell--column-header {\r\n    align-items: center;\r\n    display: flex;\r\n    gap: 1rem;\r\n    justify-content: center;\r\n    min-width: 8rem;\r\n  }\r\n  .pg-cell-wrapper--data {\r\n    cursor: pointer;\r\n  }\r\n  .pg-cell-wrapper--data-empty {\r\n    background-color: var(--color-empty);\r\n  }\r\n  .pg-loading {\r\n    --color-loading-primary: steelblue;\r\n    --color-loading-secondary: white;\r\n    --size-loader: 5rem;\r\n    height: 10rem;\r\n    width: 100%;\r\n    position: relative;\r\n    z-index: 1;\r\n  }\r\n  .pg-loading:before,\r\n  .pg-loading:after {\r\n    bottom: 0;\r\n    border-radius: 50%;\r\n    content: '';\r\n    display: block;\r\n    left: 0;\r\n    margin: auto;\r\n    position: absolute;\r\n    right: 0;\r\n    top: 0;\r\n    z-index: 2;\r\n  }\r\n  @keyframes spin {\r\n    from { transform: rotate(0deg); }\r\n    to { transform: rotate(359deg); }\r\n  }\r\n  .pg-loading:before {\r\n    animation: spin 1s linear infinite;\r\n    background-image: conic-gradient(var(--color-loading-primary), var(--color-loading-secondary));\r\n    border: 0.4rem solid var(--color-loading-primary);\r\n    height: var(--size-loader);\r\n    width: var(--size-loader);\r\n    z-index: 1;\r\n  }\r\n  .pg-loading:after {\r\n    background-color: var(--color-loading-primary);\r\n    border: 0 solid;\r\n    height: calc(var(--size-loader) - 1rem);\r\n    width: calc(var(--size-loader) - 1rem);\r\n    z-index: 2;\r\n  }\r\n  .pg-favorite-icon {\r\n    font-size: 2rem;\r\n    font-style: normal;\r\n    line-height: 2rem;\r\n  }\r\n  .pg-more-icon {\r\n    background-color: var(--color-header);\r\n    border: 0.8rem solid var(--color-header-content);\r\n    display: block;\r\n    position: relative;\r\n    vertical-align: middle;\r\n    z-index: 0;\r\n  }\r\n  .pg-more-icon,\r\n  .pg-more-icon:before,\r\n  .pg-more-icon:after {\r\n    border-radius: 50%;\r\n    height: 0.4rem;\r\n    width: 0.4rem;\r\n  }\r\n  .pg-more-icon:before,\r\n  .pg-more-icon:after {\r\n    background-color: var(--color-header);\r\n    border: 0 solid;\r\n    content: '';\r\n    display: block;\r\n    position: absolute;\r\n    top: 0;\r\n    z-index: 1;\r\n  }\r\n  .pg-more-icon:before {\r\n    left: -0.5rem;\r\n  }\r\n  .pg-more-icon:after {\r\n    right: -0.5rem;\r\n  }\r\n  .pg-dialog {\r\n    background-color: var(--color-header);\r\n    bottom: 0;\r\n    border: 0 solid;\r\n    border-radius: 0.5rem;\r\n    box-shadow: 0 0 1rem rgba(0, 0, 0, 0.5);\r\n    box-sizing: border-box;\r\n    color: var(--color-header-content);\r\n    height: max-content;\r\n    left: 0;\r\n    margin: auto;\r\n    max-height: 100vh;\r\n    max-width: 40rem;\r\n    min-height: 40rem;\r\n    position: fixed;\r\n    right: 0;\r\n    top: 0;\r\n    width: calc(100% - 0.5rem);\r\n    z-index: 2;\r\n  }\r\n  .pg-dialog + .backdrop {\r\n    background-color: rgba(0, 0, 0, 0.8);\r\n  }\r\n  /* ::backdrop must be kept separate because of safari */\r\n  .pg-dialog::backdrop {\r\n    background-color: rgba(0, 0, 0, 0.8);\r\n  }\r\n  .pg-dialog-header {\r\n    display: grid;\r\n    grid-template-columns: 1fr auto;\r\n  }\r\n  .pg-dialog-title {\r\n    margin: 0;\r\n  }\r\n  .pg-dialog-details {\r\n    padding-top: 1rem;\r\n  }\r\n  .pg-dialog-select {\r\n    border: 0 solid;\r\n    border-radius: 0.3rem;\r\n    padding: 0.5rem;\r\n  }\r\n  .pg-dialog-close {\r\n    align-items: center;\r\n    background-color: var(--color-header-content);\r\n    border: 0 solid;\r\n    border-radius: 50%;\r\n    color: var(--color-header);\r\n    cursor: pointer;\r\n    display: flex;\r\n    height: 2rem;\r\n    justify-content: center;\r\n    width: 2rem;\r\n  }\r\n  .pg-close-icon {\r\n    height: 100%;\r\n    display: block;\r\n    position: relative;\r\n    width: 100%;\r\n  }\r\n  .pg-close-icon:before,\r\n  .pg-close-icon:after {\r\n    background-color: var(--color-header);\r\n    bottom: 0;\r\n    content: '';\r\n    display: block;\r\n    height: 1.3rem;\r\n    left: 0;\r\n    margin: auto;\r\n    position: absolute;\r\n    right: 0;\r\n    top: 0;\r\n    width: 0.2rem;\r\n  }\r\n  .pg-close-icon:before {\r\n    transform: rotate(45deg);\r\n  }\r\n  .pg-close-icon:after {\r\n    transform: rotate(-45deg);\r\n  }\r\n  .pg-dialog-menu {\r\n    display: grid;\r\n    gap: 0.5rem;\r\n    margin: 0 auto;\r\n    max-width: 30rem;\r\n    padding: 2rem 2rem 0;\r\n  }\r\n  .pg-dialog-menu-title {\r\n    width: max-content;\r\n    margin: 0 auto;\r\n  }\r\n  .pg-search-input,\r\n  .pg-search-button,\r\n  .pg-dialog-menu-item {\r\n    align-items: center;\r\n    background-color: var(--color-cell);\r\n    border: none;\r\n    box-shadow: 0 0 1.2rem rgba(0, 0, 0, 0.5);\r\n    color: var(--color-content);\r\n    cursor: pointer;\r\n    display: flex;\r\n    gap: 0.5rem;\r\n    justify-content: center;\r\n    padding: 1rem 0.5rem;\r\n  }\r\n  .pg-search-input,\r\n  .pg-dialog-menu-item--input,\r\n  .pg-dialog-menu-input {\r\n    cursor: text;\r\n  }\r\n  .pg-search-input,\r\n  .pg-search-button {\r\n    padding: 0.5rem 1rem;\r\n  }\r\n  .pg-search-input {\r\n    min-width: 0;\r\n  }\r\n  .pg-dialog-menu-input {\r\n    background-color: transparent;\r\n    border: none;\r\n  }\r\n  .pg-dialog-menu-input--time {\r\n    width: 10.2rem;\r\n  }\r\n  .pg-dialog-menu-special-item {\r\n    display: grid;\r\n    gap: 0.5rem;\r\n    grid-template-columns: 2fr 1fr;\r\n  }\r\n  .pg-dialog-body {\r\n    display: grid;\r\n    grid-auto-rows: auto;\r\n    grid-template-rows: auto minmax(0, 1fr);\r\n    height: 100%;\r\n    max-height: calc(100vh - 2rem);\r\n    min-height: 38rem;\r\n    overflow: hidden;\r\n    position: relative;\r\n  }\r\n  .pg-dialog-body:before,\r\n  .pg-dialog-body:after {\r\n    content: '\\\\02771';\r\n    color: var(--color-header);\r\n    display: inline-block;\r\n    font-size: 3rem;\r\n    height: 3rem;\r\n    left: 0;\r\n    line-height: 3rem;\r\n    margin: auto;\r\n    position: absolute;\r\n    right: 0;\r\n    width: 3rem;\r\n  }\r\n  .pg-dialog-body:before {\r\n    top: 1rem;\r\n    transform: rotate(-90deg);\r\n  }\r\n  .pg-dialog-body:after {\r\n    bottom: -1.8rem;\r\n    transform: rotate(90deg);\r\n  }\r\n  .pg-dialog-content {\r\n    overflow: auto;\r\n    padding-bottom: 2rem;\r\n  }\r\n  .pg-dialog-content--text-container,\r\n  .pg-dialog-footer {\r\n    background-color: var(--color-cell);\r\n    border: 0 solid;\r\n    border-radius: 0.5rem;\r\n    color: var(--color-content);\r\n    margin: 2rem 0 0;\r\n    text-align: center;\r\n  }\r\n  .pg-dialog-content--text-container:after {\r\n    background-image: linear-gradient(transparent, var(--color-cell) 90%);\r\n    bottom: -2rem;\r\n    content: '';\r\n    display: block;\r\n    height: 4rem;\r\n    left: 0;\r\n    position: sticky;\r\n    width: 100%;\r\n  }\r\n  .pg-dialog-paragraph {\r\n    margin: 0;\r\n    padding: 1rem;\r\n  }\r\n  .pg-time {\r\n    display: inline-block;\r\n    font-weight: bold;\r\n  }\r\n  .pg-dialog-footer {\r\n    padding: 1rem;\r\n  }\r\n  @media (max-width: ${breakpoint}) {\r\n    .pg-cell-wrapper--column-header,\r\n    .pg-cell-wrapper--data,\r\n    .pg-cell-wrapper--data-empty,\r\n    .pg-cell-wrapper--corner-collapsed .pg-corner-text {\r\n      display: none;\r\n    }\r\n    .pg-cell-wrapper--column-header-active,\r\n    .pg-cell-wrapper--column-header-time,\r\n    .pg-cell-wrapper--data-active,\r\n    .pg-cell-wrapper--data-time,\r\n    .pg-cell-wrapper--data-favorite,\r\n    .pg-cell-wrapper--data-search,\r\n    .pg-cell-wrapper--data-empty-time,\r\n    .pg-cell-wrapper--data-empty-active {\r\n      display: revert;\r\n      min-width: 0;\r\n    }\r\n    .pg-cell--data {\r\n      margin: 0;\r\n    }\r\n    .pg-cell--data-search,\r\n    .pg-cell--data-favorite {\r\n      margin: auto;\r\n    }\r\n    .pg-cell-wrapper--corner,\r\n    .pg-cell-wrapper--row-header-time,\r\n    .pg-cell-wrapper--row-header-time:after {\r\n      transition: all 0.5s;\r\n    }\r\n    .pg-cell-wrapper--row-header-time {\r\n      cursor: pointer;\r\n    }\r\n    .pg-cell-wrapper--row-header-time:after {\r\n      bottom: 0;\r\n      content: '\\\\25C0';\r\n      display: inline-block;\r\n      font-size: 1rem;\r\n      height: 1rem;\r\n      margin: auto;\r\n      position: absolute;\r\n      right: 0;\r\n      top: 0;\r\n    }\r\n    .pg-cell-wrapper--corner-collapsed,\r\n    .pg-cell-wrapper--row-header-collapsed {\r\n      left: -9.5rem;\r\n    }\r\n    .pg-cell-wrapper--row-header-collapsed:after {\r\n      transform: rotate(180deg);\r\n    }\r\n    .pg-cell-wrapper--corner-collapsed {\r\n      padding-right: 0;\r\n    }\r\n    .pg-cell-wrapper--corner-collapsed .pg-cell--corner {\r\n      grid-template-columns: auto;\r\n      justify-content: right;\r\n    }\r\n  }\r\n`\r\n","import { WholeNumber } from '../../utilities'\r\n\r\n// converts dates to actual `Date()` objects\r\nexport const getActiveEvent = event => ({\r\n  ...event,\r\n  start: new Date(event.start),\r\n  end: new Date(event.end),\r\n})\r\n\r\n\r\n// gets all data needed for one cell, so the logic doesn't clutter the template\r\nexport const getCellData = ({ events, spanState, date, interval, _location, sortBy, currentTime }) => {\r\n\r\n  // find an event starting at this time\r\n  const _event = events.find(e =>\r\n    Number(e.start) === Number(date)\r\n    && e.location === _location\r\n  )\r\n\r\n  // handle events that already started before the start time\r\n  const event = !_event\r\n    ? events.find(e =>\r\n        Number(e.end) > Number(date)\r\n        && Number(e.start) < Number(currentTime)\r\n        && e.location === _location\r\n      )\r\n    : _event\r\n\r\n  const hasStarted = event ? event.start < currentTime : false\r\n  const eventName = event ? event.name : ''\r\n  const cellType = event ? 'data' : 'data-empty'\r\n  const getStart = event => hasStarted ? currentTime : event.start\r\n  const duration = event ? WholeNumber((event.end - getStart(event)) / 1000 / 60) : 0\r\n  const span = duration ? WholeNumber(duration / interval) : 1\r\n  const blank = sortBy === 'location' ? spanState[_location] > 0 : spanState[_location] > 1\r\n\r\n  // handle spanState to prevent extra columns\r\n  if (blank) --spanState[_location]\r\n  else if (span > 1) spanState[_location] = span\r\n\r\n  // return all necessary information included in the template\r\n  return { eventName, cellType, span, blank, event, hasStarted }\r\n}\r\n","import { DEFAULT_BREAKPOINT, DEFAULT_TIMES } from '../../constants'\r\nimport { mapString, runMethod } from '../../utilities'\r\n\r\nconst renderSortDialog = ({ locations, times, activeDay, activeTime: _activeTime, dataset }) => {\r\n\r\n  // only show location list if the columns are collapsed\r\n  const { breakpoint = DEFAULT_BREAKPOINT } = dataset\r\n  const beyondThreshold = !window.matchMedia(`(max-width: ${breakpoint})`).matches\r\n\r\n  const { days, interval } = times || DEFAULT_TIMES\r\n  const getTimeValue = date => date.toLocaleTimeString([], { hour12: false, timeStyle: 'short' })\r\n  const activeTime = getTimeValue(_activeTime)\r\n  const currentTimes = days[activeDay]\r\n  const minTime = getTimeValue(currentTimes[0].date)\r\n  const maxTime = getTimeValue(currentTimes[currentTimes.length - 1].date)\r\n  const step = interval * 60\r\n\r\n  return /* html */`\r\n    <section class=\"pg-dialog-body\">\r\n      <header class=\"pg-dialog-header\">\r\n        <h1 class=\"pg-dialog-title\">Options</h1>\r\n        <button class=\"pg-dialog-close\" title=\"Close\" onclick=\"${runMethod('toggleSortDialog', false)}\"><i class=\"pg-close-icon\" title=\"Close\"></i></button>\r\n      </header>\r\n      <section class=\"pg-dialog-content\">\r\n        <menu class=\"pg-dialog-menu\">\r\n          <button class=\"pg-dialog-menu-item\" onclick=\"${runMethod('selectSortBy', 'favorites')}\">\r\n            <i class=\"pg-favorite-icon\" title=\"View Favorites\">&starf;</i>\r\n            <span>View Favorites</span>\r\n          </button>\r\n        </menu>\r\n        <menu class=\"pg-dialog-menu\">\r\n          <h2 class=\"pg-dialog-menu-title\">Which day?</h2>\r\n          <select class=\"pg-dialog-select\" onchange=\"${runMethod('selectActiveDay')}\">\r\n            ${mapString(Object.keys(days), day => /* html */`\r\n              <option value=\"${day}\" ${day === activeDay ? 'selected' : ''}>${day}</option>\r\n            `)}\r\n          </select>\r\n        </menu>\r\n        <menu class=\"pg-dialog-menu\">\r\n          <h2 class=\"pg-dialog-menu-title\">Filter by Time</h2>\r\n          <button class=\"pg-dialog-menu-item\" onclick=\"${runMethod('selectSortBy', 'allTime')}\" autofocus>All Times This Day</button>\r\n          <button class=\"pg-dialog-menu-item\" onclick=\"${runMethod('selectSortBy', 'now')}\">Right Now &amp; Onward</button>\r\n          <button class=\"pg-dialog-menu-item\" onclick=\"${runMethod('selectSortBy', 'nowOnly')}\">Right Now Only</button>\r\n          <div class=\"pg-dialog-menu-special-item\">\r\n            <div class=\"pg-dialog-menu-item pg-dialog-menu-item--input\">\r\n              <input\r\n                type=\"time\"\r\n                class=\"pg-dialog-menu-input pg-dialog-menu-input--time\"\r\n                value=\"${activeTime}\"\r\n                min=\"${minTime}\"\r\n                max=\"${maxTime}\"\r\n                step=\"${step}\"\r\n                onchange=\"${runMethod('selectActiveTime')}\"\r\n              />\r\n              <span class=\"pg-inline-text\">&amp; On</span>\r\n            </div>\r\n            <button class=\"pg-dialog-menu-item\" onclick=\"${runMethod('selectSortBy', 'time')}\">Go &roarr;</button>\r\n          </div>\r\n        </menu>\r\n        <menu class=\"pg-dialog-menu\">\r\n          <h2 class=\"pg-dialog-menu-title\">Filter by Location</h2>\r\n          ${beyondThreshold\r\n            ? /* html */`<button class=\"pg-dialog-menu-item\" onclick=\"${runMethod('selectSortBy', 'location')}\">All Locations</button>`\r\n            : mapString(locations, _location => /* html */`\r\n              <button class=\"pg-dialog-menu-item\" onclick=\"${runMethod('selectActiveLocation', _location)}\">${_location}</button>\r\n            `)\r\n          }\r\n        </menu>\r\n      </section>\r\n    </section>\r\n  `\r\n}\r\n\r\nexport default renderSortDialog\r\n","import { mapString, runMethod } from '../../utilities'\r\n\r\nconst renderEventDialog = ({ favorites, activeEvent }) => {\r\n\r\n  const existingFavorite = favorites.find(({ location: _location, start, name }) => {\r\n    const { location: aLocation, start: aStart, name: aName } = activeEvent\r\n    return _location === aLocation && Number(new Date(start)) === Number(aStart) && name === aName\r\n  })\r\n  const favoriteMethod = existingFavorite ? 'removeFavorite' : 'addFavorite'\r\n  const favoriteText = existingFavorite ? 'Remove from Favorites' : 'Add to Favorites'\r\n\r\n  return /* html */`\r\n    <article class=\"pg-dialog-body\">\r\n      <header class=\"pg-dialog-header\">\r\n        <h1 class=\"pg-dialog-title\">${activeEvent.name}</h1>\r\n        <button class=\"pg-dialog-close\" onclick=\"${runMethod('closeEventDialog')}\"><i class=\"pg-close-icon\" title=\"Close\"></i></button>\r\n      </header>\r\n      <section class=\"pg-dialog-content pg-dialog-content--text-container\">\r\n        ${mapString(activeEvent.description.split(/\\n/), paragraph => /* html */`\r\n          <p class=\"pg-dialog-paragraph\">${paragraph}</p>\r\n        `)}\r\n      </section>\r\n      <footer class=\"pg-dialog-footer\">\r\n        <time datetime=\"${activeEvent.start.toISOString()}\" class=\"pg-time pg-time--start\">\r\n          ${activeEvent.start.toLocaleTimeString('en-US', { timeStyle: 'short' })}\r\n        </time>\r\n        to\r\n        <time datetime=\"${activeEvent.end.toISOString()}\" class=\"pg-time pg-time--end\">\r\n          ${activeEvent.end.toLocaleTimeString('en-US', { timeStyle: 'short' })}\r\n        </time>\r\n        <div>@ ${activeEvent.location}</div>\r\n        <div class=\"pg-dialog-details\">\r\n          <div><strong>Hosted by:</strong> <span>${activeEvent.host}</span></div>\r\n          <div><strong>Category:</strong> <span>${activeEvent.category}</span></div>\r\n        </div>\r\n      </footer>\r\n      <section class=\"pg-dialog-content\">\r\n        <menu class=\"pg-dialog-menu\">\r\n          <button class=\"pg-dialog-menu-item\" onclick=\"${runMethod(favoriteMethod, activeEvent)}\" autofocus>\r\n            <span>${favoriteText}</span>\r\n            <i class=\"pg-favorite-icon\" title=\"${favoriteText}\">&starf;</i>\r\n          </button>\r\n        </menu>\r\n      </section>\r\n    </article>\r\n  `\r\n}\r\n\r\nexport default renderEventDialog\r\n","import { DEFAULT_TIMES } from '../../constants'\r\nimport { getEventId, mapString, runMethod, trim } from '../../utilities'\r\nimport { getCellData } from './componentUtils'\r\n\r\nconst renderByLocation = ({ activeLocation, events, times: allTimes, locations, sortBy, activeDay }) => {\r\n\r\n  const { days, interval } = allTimes || DEFAULT_TIMES\r\n\r\n  // this keeps rowspans from previous iterations in memory\r\n  // so we can avoid adding extra table cells.\r\n  const spanState = {}\r\n\r\n  // utility to check if the given location is active and return the class accordingly\r\n  const getActiveClass = (_location, className) => activeLocation === _location ? className : ''\r\n\r\n  // get all the times in the current day\r\n  const times = days[activeDay]\r\n\r\n  return /* html */`\r\n    <div class=\"pg-table-wrapper\">\r\n      <table class=\"pg-table\">\r\n        <thead class=\"pg-header\">\r\n          <tr class=\"pg-row\">\r\n            <td class=\"pg-cell-wrapper pg-cell-wrapper--corner\" onclick=\"${runMethod('toggleSortDialog', true)}\">\r\n              <div class=\"pg-cell pg-cell--corner\"><i class=\"pg-more-icon\" title=\"Options...\"></i> <span class=\"pg-corner-text\">${activeDay}</span></div>\r\n            </td>\r\n            ${mapString(locations, _location => /* html */`\r\n              <th class=\"pg-cell-wrapper pg-cell-wrapper--column-header ${getActiveClass(_location, 'pg-cell-wrapper--column-header-active')}\">\r\n                <div class=\"pg-cell pg-cell--column-header ${getActiveClass(_location, 'pg-cell--column-header-active')}\">${_location}</div>\r\n              </th>\r\n            `)}\r\n          </tr>\r\n        </thead>\r\n        <tbody class=\"pg-body\">\r\n          ${mapString(times, ({ date, timeString }) => /* html */`\r\n            <tr class=\"pg-row\">\r\n              <th class=\"pg-cell-wrapper pg-cell-wrapper--row-header\">\r\n                <div class=\"pg-cell pg-cell--row-header\">${timeString}</div>\r\n              </th>\r\n              ${mapString(locations, _location => {\r\n                const { eventName, cellType, span, blank, event } = getCellData({ events, spanState, date, interval, _location, sortBy })\r\n                if (blank) return '' // blank if cell from previous row occupies this space\r\n                return /* html */`\r\n                  <td\r\n                    class=\"pg-cell-wrapper pg-cell-wrapper--${cellType} ${getActiveClass(_location, `pg-cell-wrapper--${cellType}-active`)}\"\r\n                    rowspan=\"${span}\"\r\n                    id=\"${event ? getEventId(event) : ''}\"\r\n                    ${event ? `onclick=\"${runMethod('openEventDialog', event)}\"` : ''}\r\n                  >\r\n                    <div class=\"pg-cell pg-cell--${cellType} ${getActiveClass(_location, `pg-cell--${cellType}-active`)}\">${trim(eventName)}</div>\r\n                  </td>\r\n                `\r\n              })}\r\n            </tr>\r\n          `)}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  `\r\n}\r\n\r\nexport default renderByLocation\r\n","import { DEFAULT_TIMES } from '../../constants'\r\nimport { getDateInfo, getEventId, mapString, roundMinutes, runMethod, trim } from '../../utilities'\r\nimport { getCellData } from './componentUtils'\r\n\r\nconst renderByTime = ({ events, times: allTimes, locations, sortBy, activeTime, activeDay }) => {\r\n\r\n  const { days, interval } = allTimes || DEFAULT_TIMES\r\n\r\n  // this keeps colspans from previous iterations in memory\r\n  // so we can avoid adding extra table cells.\r\n  const spanState = {}\r\n\r\n  // determine how to filter times\r\n  const _times = days[activeDay]\r\n  const now = roundMinutes(Date.now(), interval)\r\n  const { day: nowDay, date: nowDate, time: nowTime } = getDateInfo(now)\r\n  const filterMap = {\r\n    now: _times.filter(({ date }) => date >= now),\r\n    nowOnly: _times.filter(({ date }) => date === now),\r\n    time: _times.filter(({ date }) => date >= activeTime),\r\n    allTime: _times,\r\n  }\r\n  const filteredTimes = filterMap[sortBy]\r\n  const times = filteredTimes.length ? filteredTimes : [{ date: now, timeString: nowTime }]\r\n  const currentDay = filteredTimes.length ? activeDay : `${nowDay} ${nowDate}`\r\n  const timeMap = {\r\n    now,\r\n    nowOnly: now,\r\n    time: activeTime,\r\n    allTime: new Date(0),\r\n  }\r\n  const currentTime = timeMap[sortBy]\r\n\r\n  return /* html */`\r\n    <div class=\"pg-table-wrapper\">\r\n      <table class=\"pg-table\">\r\n        <thead class=\"pg-header\">\r\n          <tr class=\"pg-row\">\r\n            <td class=\"pg-cell-wrapper pg-cell-wrapper--corner\" onclick=\"${runMethod('toggleSortDialog', true)}\">\r\n              <div class=\"pg-cell pg-cell--corner\"><i class=\"pg-more-icon\" title=\"Options...\"></i> <span class=\"pg-corner-text\">${currentDay}</span></div>\r\n            </td>\r\n            ${mapString(times, ({ date, timeString }) => /* html */`\r\n              <th class=\"pg-cell-wrapper pg-cell-wrapper--column-header pg-cell-wrapper--column-header-time ${date === now ? 'pg-cell-wrapper--column-header-active-time' : ''}\">\r\n                <div class=\"pg-cell pg-cell--column-header pg-cell--column-header-time\">\r\n                  <span>${timeString}</span>\r\n                  <div>${date === now ? '(Current Time)' : ''}</div>\r\n                </div>\r\n              </th>\r\n            `)}\r\n          </tr>\r\n        </thead>\r\n        <tbody class=\"pg-body\">\r\n          ${mapString(locations, _location => /* html */`\r\n            <tr class=\"pg-row\">\r\n              <th class=\"pg-cell-wrapper pg-cell-wrapper--row-header pg-cell-wrapper--row-header-time\" onclick=\"${runMethod('toggleHeaders')}\">\r\n                <div class=\"pg-cell pg-cell--row-header\">${_location}</div>\r\n              </th>\r\n              ${mapString(times, ({ date }) => {\r\n                const { eventName, cellType, span, blank, event, hasStarted } = getCellData({ events, spanState, date, interval, _location, sortBy, currentTime })\r\n                if (blank) return '' // blank if cell from previous row occupies this space\r\n                return /* html */`\r\n                  <td\r\n                    class=\"pg-cell-wrapper pg-cell-wrapper--${cellType} pg-cell-wrapper--${cellType}-time ${hasStarted ? 'pg-cell-wrapper--overflow' : ''}\"\r\n                    colspan=\"${span}\"\r\n                    id=\"${event ? getEventId(event) : ''}\"\r\n                    ${event ? `onclick=\"${runMethod('openEventDialog', event)}\"` : ''}\r\n                  >\r\n                    <div class=\"pg-cell pg-cell--${cellType} pg-cell--${cellType}-time\">${trim(eventName)}</div>\r\n                  </td>\r\n                `\r\n              })}\r\n            </tr>\r\n          `)}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  `\r\n}\r\n\r\nexport default renderByTime\r\n","import { mapString, runMethod, getDateInfo, trim } from '../../utilities'\r\n\r\nconst renderFavorites = ({ favorites }) => /* html */`\r\n  <div class=\"pg-table-wrapper\">\r\n    <table class=\"pg-table\">\r\n      <thead class=\"pg-header\">\r\n        <tr class=\"pg-row\">\r\n          <td class=\"pg-cell-wrapper pg-cell-wrapper--corner\" onclick=\"${runMethod('toggleSortDialog', true)}\">\r\n            <div class=\"pg-cell pg-cell--corner\"><i class=\"pg-more-icon\" title=\"Options...\"></i> Favorites</div>\r\n          </td>\r\n        </tr>\r\n      </thead>\r\n      <tbody class=\"pg-body\">\r\n        ${favorites.length === 0\r\n          ? /* html */`\r\n              <tr class=\"pg-row\">\r\n                <td class=\"pg-cell-wrapper pg-cell-wrapper--data pg-cell-wrapper--data-favorite\">\r\n                  <div class=\"pg-cell pg-cell--data pg-cell--data-favorite\">You have no favorites.</div>\r\n                </td>\r\n              </tr>\r\n            `\r\n          : mapString(favorites, event => {\r\n            const { start, end, name, location } = event\r\n            const startDate = getDateInfo(start)\r\n            const endDate = getDateInfo(end)\r\n            const day = `${startDate.day} ${startDate.date}`\r\n            const startTime = startDate.time\r\n            const endTime = endDate.time\r\n            return /* html */`\r\n              <tr class=\"pg-row\">\r\n                <td class=\"pg-cell-wrapper pg-cell-wrapper--data pg-cell-wrapper--data-favorite\" onclick=\"${runMethod('openEventDialog', event)}\">\r\n                  <div class=\"pg-cell pg-cell--data pg-cell--data-favorite\">\r\n                    <span class=\"pg-search-result-name\">${trim(name)}</span>\r\n                    <span class=\"pg-inline-result-details\">${day}</span>\r\n                    <span class=\"pg-search-result-details\">\r\n                      <span class=\"pg-inline-text\">${startTime}</span>\r\n                      <span class=\"pg-inline-text\">- ${endTime}</span>\r\n                      <span class=\"pg-inline-text\"> @ ${location}</span>\r\n                    </span>\r\n                  </div>\r\n                </td>\r\n              </tr>\r\n            `\r\n          })\r\n        }\r\n      </tbody>\r\n    </table>\r\n  </div>\r\n`\r\n\r\nexport default renderFavorites\r\n","import { getDateInfo, mapString, runMethod, trim } from '../../utilities'\r\n\r\nconst renderSearchResults = ({ searchResults }) => /* html */`\r\n  <div class=\"pg-table-wrapper\">\r\n    <table class=\"pg-table\">\r\n      <thead class=\"pg-header\">\r\n        <tr class=\"pg-row\">\r\n          <td class=\"pg-cell-wrapper pg-cell-wrapper--corner\" onclick=\"${runMethod('toggleSortDialog', true)}\">\r\n            <div class=\"pg-cell pg-cell--corner\"><i class=\"pg-more-icon\" title=\"Options...\"></i> Search Results</div>\r\n          </td>\r\n        </tr>\r\n      </thead>\r\n      <tbody class=\"pg-body\">\r\n        ${searchResults.length === 0\r\n          ? /* html */`\r\n              <tr class=\"pg-row\">\r\n                <td class=\"pg-cell-wrapper pg-cell-wrapper--data pg-cell-wrapper--data-search\">\r\n                  <div class=\"pg-cell pg-cell--data pg-cell--data-search\">No results found.</div>\r\n                </td>\r\n              </tr>\r\n            `\r\n          : mapString(searchResults, event => {\r\n            const { start, end, name, location } = event\r\n            const startDate = getDateInfo(start)\r\n            const endDate = getDateInfo(end)\r\n            const day = `${startDate.day} ${startDate.date}`\r\n            const startTime = startDate.time\r\n            const endTime = endDate.time\r\n            return /* html */`\r\n              <tr class=\"pg-row\">\r\n                <td class=\"pg-cell-wrapper pg-cell-wrapper--data pg-cell-wrapper--data-search\" onclick=\"${runMethod('openEventDialog', event)}\">\r\n                  <div class=\"pg-cell pg-cell--data pg-cell--data-search\">\r\n                    <span class=\"pg-search-result-name\">${trim(name)}</span>\r\n                    <span class=\"pg-inline-result-details\">${day}</span>\r\n                    <span class=\"pg-search-result-details\">\r\n                      <span class=\"pg-inline-text\">${startTime}</span>\r\n                      <span class=\"pg-inline-text\">- ${endTime}</span>\r\n                      <span class=\"pg-inline-text\"> @ ${location}</span>\r\n                    </span>\r\n                  </div>\r\n                </td>\r\n              </tr>\r\n            `\r\n          })\r\n        }\r\n      </tbody>\r\n    </table>\r\n  </div>\r\n`\r\n\r\nexport default renderSearchResults\r\n","// nb. This is for IE10 and lower _only_.\nvar supportCustomEvent = window.CustomEvent;\nif (!supportCustomEvent || typeof supportCustomEvent === 'object') {\n  supportCustomEvent = function CustomEvent(event, x) {\n    x = x || {};\n    var ev = document.createEvent('CustomEvent');\n    ev.initCustomEvent(event, !!x.bubbles, !!x.cancelable, x.detail || null);\n    return ev;\n  };\n  supportCustomEvent.prototype = window.Event.prototype;\n}\n\n/**\n * Dispatches the passed event to both an \"on<type>\" handler as well as via the\n * normal dispatch operation. Does not bubble.\n *\n * @param {!EventTarget} target\n * @param {!Event} event\n * @return {boolean}\n */\nfunction safeDispatchEvent(target, event) {\n  var check = 'on' + event.type.toLowerCase();\n  if (typeof target[check] === 'function') {\n    target[check](event);\n  }\n  return target.dispatchEvent(event);\n}\n\n/**\n * @param {Element} el to check for stacking context\n * @return {boolean} whether this el or its parents creates a stacking context\n */\nfunction createsStackingContext(el) {\n  while (el && el !== document.body) {\n    var s = window.getComputedStyle(el);\n    var invalid = function(k, ok) {\n      return !(s[k] === undefined || s[k] === ok);\n    };\n\n    if (s.opacity < 1 ||\n        invalid('zIndex', 'auto') ||\n        invalid('transform', 'none') ||\n        invalid('mixBlendMode', 'normal') ||\n        invalid('filter', 'none') ||\n        invalid('perspective', 'none') ||\n        s['isolation'] === 'isolate' ||\n        s.position === 'fixed' ||\n        s.webkitOverflowScrolling === 'touch') {\n      return true;\n    }\n    el = el.parentElement;\n  }\n  return false;\n}\n\n/**\n * Finds the nearest <dialog> from the passed element.\n *\n * @param {Element} el to search from\n * @return {HTMLDialogElement} dialog found\n */\nfunction findNearestDialog(el) {\n  while (el) {\n    if (el.localName === 'dialog') {\n      return /** @type {HTMLDialogElement} */ (el);\n    }\n    if (el.parentElement) {\n      el = el.parentElement;\n    } else if (el.parentNode) {\n      el = el.parentNode.host;\n    } else {\n      el = null;\n    }\n  }\n  return null;\n}\n\n/**\n * Blur the specified element, as long as it's not the HTML body element.\n * This works around an IE9/10 bug - blurring the body causes Windows to\n * blur the whole application.\n *\n * @param {Element} el to blur\n */\nfunction safeBlur(el) {\n  // Find the actual focused element when the active element is inside a shadow root\n  while (el && el.shadowRoot && el.shadowRoot.activeElement) {\n    el = el.shadowRoot.activeElement;\n  }\n\n  if (el && el.blur && el !== document.body) {\n    el.blur();\n  }\n}\n\n/**\n * @param {!NodeList} nodeList to search\n * @param {Node} node to find\n * @return {boolean} whether node is inside nodeList\n */\nfunction inNodeList(nodeList, node) {\n  for (var i = 0; i < nodeList.length; ++i) {\n    if (nodeList[i] === node) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * @param {HTMLFormElement} el to check\n * @return {boolean} whether this form has method=\"dialog\"\n */\nfunction isFormMethodDialog(el) {\n  if (!el || !el.hasAttribute('method')) {\n    return false;\n  }\n  return el.getAttribute('method').toLowerCase() === 'dialog';\n}\n\n/**\n * @param {!DocumentFragment|!Element} hostElement\n * @return {?Element}\n */\nfunction findFocusableElementWithin(hostElement) {\n  // Note that this is 'any focusable area'. This list is probably not exhaustive, but the\n  // alternative involves stepping through and trying to focus everything.\n  var opts = ['button', 'input', 'keygen', 'select', 'textarea'];\n  var query = opts.map(function(el) {\n    return el + ':not([disabled])';\n  });\n  // TODO(samthor): tabindex values that are not numeric are not focusable.\n  query.push('[tabindex]:not([disabled]):not([tabindex=\"\"])');  // tabindex != \"\", not disabled\n  var target = hostElement.querySelector(query.join(', '));\n\n  if (!target && 'attachShadow' in Element.prototype) {\n    // If we haven't found a focusable target, see if the host element contains an element\n    // which has a shadowRoot.\n    // Recursively search for the first focusable item in shadow roots.\n    var elems = hostElement.querySelectorAll('*');\n    for (var i = 0; i < elems.length; i++) {\n      if (elems[i].tagName && elems[i].shadowRoot) {\n        target = findFocusableElementWithin(elems[i].shadowRoot);\n        if (target) {\n          break;\n        }\n      }\n    }\n  }\n  return target;\n}\n\n/**\n * Determines if an element is attached to the DOM.\n * @param {Element} element to check\n * @return {boolean} whether the element is in DOM\n */\nfunction isConnected(element) {\n  return element.isConnected || document.body.contains(element);\n}\n\n/**\n * @param {!Event} event\n * @return {?Element}\n */\nfunction findFormSubmitter(event) {\n  if (event.submitter) {\n    return event.submitter;\n  }\n\n  var form = event.target;\n  if (!(form instanceof HTMLFormElement)) {\n    return null;\n  }\n\n  var submitter = dialogPolyfill.formSubmitter;\n  if (!submitter) {\n    var target = event.target;\n    var root = ('getRootNode' in target && target.getRootNode() || document);\n    submitter = root.activeElement;\n  }\n\n  if (!submitter || submitter.form !== form) {\n    return null;\n  }\n  return submitter;\n}\n\n/**\n * @param {!Event} event\n */\nfunction maybeHandleSubmit(event) {\n  if (event.defaultPrevented) {\n    return;\n  }\n  var form = /** @type {!HTMLFormElement} */ (event.target);\n\n  // We'd have a value if we clicked on an imagemap.\n  var value = dialogPolyfill.imagemapUseValue;\n  var submitter = findFormSubmitter(event);\n  if (value === null && submitter) {\n    value = submitter.value;\n  }\n\n  // There should always be a dialog as this handler is added specifically on them, but check just\n  // in case.\n  var dialog = findNearestDialog(form);\n  if (!dialog) {\n    return;\n  }\n\n  // Prefer formmethod on the button.\n  var formmethod = submitter && submitter.getAttribute('formmethod') || form.getAttribute('method');\n  if (formmethod !== 'dialog') {\n    return;\n  }\n  event.preventDefault();\n\n  if (value != null) {\n    // nb. we explicitly check against null/undefined\n    dialog.close(value);\n  } else {\n    dialog.close();\n  }\n}\n\n/**\n * @param {!HTMLDialogElement} dialog to upgrade\n * @constructor\n */\nfunction dialogPolyfillInfo(dialog) {\n  this.dialog_ = dialog;\n  this.replacedStyleTop_ = false;\n  this.openAsModal_ = false;\n\n  // Set a11y role. Browsers that support dialog implicitly know this already.\n  if (!dialog.hasAttribute('role')) {\n    dialog.setAttribute('role', 'dialog');\n  }\n\n  dialog.show = this.show.bind(this);\n  dialog.showModal = this.showModal.bind(this);\n  dialog.close = this.close.bind(this);\n\n  dialog.addEventListener('submit', maybeHandleSubmit, false);\n\n  if (!('returnValue' in dialog)) {\n    dialog.returnValue = '';\n  }\n\n  if ('MutationObserver' in window) {\n    var mo = new MutationObserver(this.maybeHideModal.bind(this));\n    mo.observe(dialog, {attributes: true, attributeFilter: ['open']});\n  } else {\n    // IE10 and below support. Note that DOMNodeRemoved etc fire _before_ removal. They also\n    // seem to fire even if the element was removed as part of a parent removal. Use the removed\n    // events to force downgrade (useful if removed/immediately added).\n    var removed = false;\n    var cb = function() {\n      removed ? this.downgradeModal() : this.maybeHideModal();\n      removed = false;\n    }.bind(this);\n    var timeout;\n    var delayModel = function(ev) {\n      if (ev.target !== dialog) { return; }  // not for a child element\n      var cand = 'DOMNodeRemoved';\n      removed |= (ev.type.substr(0, cand.length) === cand);\n      window.clearTimeout(timeout);\n      timeout = window.setTimeout(cb, 0);\n    };\n    ['DOMAttrModified', 'DOMNodeRemoved', 'DOMNodeRemovedFromDocument'].forEach(function(name) {\n      dialog.addEventListener(name, delayModel);\n    });\n  }\n  // Note that the DOM is observed inside DialogManager while any dialog\n  // is being displayed as a modal, to catch modal removal from the DOM.\n\n  Object.defineProperty(dialog, 'open', {\n    set: this.setOpen.bind(this),\n    get: dialog.hasAttribute.bind(dialog, 'open')\n  });\n\n  this.backdrop_ = document.createElement('div');\n  this.backdrop_.className = 'backdrop';\n  this.backdrop_.addEventListener('mouseup'  , this.backdropMouseEvent_.bind(this));\n  this.backdrop_.addEventListener('mousedown', this.backdropMouseEvent_.bind(this));\n  this.backdrop_.addEventListener('click'    , this.backdropMouseEvent_.bind(this));\n}\n\ndialogPolyfillInfo.prototype = /** @type {HTMLDialogElement.prototype} */ ({\n\n  get dialog() {\n    return this.dialog_;\n  },\n\n  /**\n   * Maybe remove this dialog from the modal top layer. This is called when\n   * a modal dialog may no longer be tenable, e.g., when the dialog is no\n   * longer open or is no longer part of the DOM.\n   */\n  maybeHideModal: function() {\n    if (this.dialog_.hasAttribute('open') && isConnected(this.dialog_)) { return; }\n    this.downgradeModal();\n  },\n\n  /**\n   * Remove this dialog from the modal top layer, leaving it as a non-modal.\n   */\n  downgradeModal: function() {\n    if (!this.openAsModal_) { return; }\n    this.openAsModal_ = false;\n    this.dialog_.style.zIndex = '';\n\n    // This won't match the native <dialog> exactly because if the user set top on a centered\n    // polyfill dialog, that top gets thrown away when the dialog is closed. Not sure it's\n    // possible to polyfill this perfectly.\n    if (this.replacedStyleTop_) {\n      this.dialog_.style.top = '';\n      this.replacedStyleTop_ = false;\n    }\n\n    // Clear the backdrop and remove from the manager.\n    this.backdrop_.parentNode && this.backdrop_.parentNode.removeChild(this.backdrop_);\n    dialogPolyfill.dm.removeDialog(this);\n  },\n\n  /**\n   * @param {boolean} value whether to open or close this dialog\n   */\n  setOpen: function(value) {\n    if (value) {\n      this.dialog_.hasAttribute('open') || this.dialog_.setAttribute('open', '');\n    } else {\n      this.dialog_.removeAttribute('open');\n      this.maybeHideModal();  // nb. redundant with MutationObserver\n    }\n  },\n\n  /**\n   * Handles mouse events ('mouseup', 'mousedown', 'click') on the fake .backdrop element, redirecting them as if\n   * they were on the dialog itself.\n   *\n   * @param {!Event} e to redirect\n   */\n  backdropMouseEvent_: function(e) {\n    if (!this.dialog_.hasAttribute('tabindex')) {\n      // Clicking on the backdrop should move the implicit cursor, even if dialog cannot be\n      // focused. Create a fake thing to focus on. If the backdrop was _before_ the dialog, this\n      // would not be needed - clicks would move the implicit cursor there.\n      var fake = document.createElement('div');\n      this.dialog_.insertBefore(fake, this.dialog_.firstChild);\n      fake.tabIndex = -1;\n      fake.focus();\n      this.dialog_.removeChild(fake);\n    } else {\n      this.dialog_.focus();\n    }\n\n    var redirectedEvent = document.createEvent('MouseEvents');\n    redirectedEvent.initMouseEvent(e.type, e.bubbles, e.cancelable, window,\n        e.detail, e.screenX, e.screenY, e.clientX, e.clientY, e.ctrlKey,\n        e.altKey, e.shiftKey, e.metaKey, e.button, e.relatedTarget);\n    this.dialog_.dispatchEvent(redirectedEvent);\n    e.stopPropagation();\n  },\n\n  /**\n   * Focuses on the first focusable element within the dialog. This will always blur the current\n   * focus, even if nothing within the dialog is found.\n   */\n  focus_: function() {\n    // Find element with `autofocus` attribute, or fall back to the first form/tabindex control.\n    var target = this.dialog_.querySelector('[autofocus]:not([disabled])');\n    if (!target && this.dialog_.tabIndex >= 0) {\n      target = this.dialog_;\n    }\n    if (!target) {\n      target = findFocusableElementWithin(this.dialog_);\n    }\n    safeBlur(document.activeElement);\n    target && target.focus();\n  },\n\n  /**\n   * Sets the zIndex for the backdrop and dialog.\n   *\n   * @param {number} dialogZ\n   * @param {number} backdropZ\n   */\n  updateZIndex: function(dialogZ, backdropZ) {\n    if (dialogZ < backdropZ) {\n      throw new Error('dialogZ should never be < backdropZ');\n    }\n    this.dialog_.style.zIndex = dialogZ;\n    this.backdrop_.style.zIndex = backdropZ;\n  },\n\n  /**\n   * Shows the dialog. If the dialog is already open, this does nothing.\n   */\n  show: function() {\n    if (!this.dialog_.open) {\n      this.setOpen(true);\n      this.focus_();\n    }\n  },\n\n  /**\n   * Show this dialog modally.\n   */\n  showModal: function() {\n    if (this.dialog_.hasAttribute('open')) {\n      throw new Error('Failed to execute \\'showModal\\' on dialog: The element is already open, and therefore cannot be opened modally.');\n    }\n    if (!isConnected(this.dialog_)) {\n      throw new Error('Failed to execute \\'showModal\\' on dialog: The element is not in a Document.');\n    }\n    if (!dialogPolyfill.dm.pushDialog(this)) {\n      throw new Error('Failed to execute \\'showModal\\' on dialog: There are too many open modal dialogs.');\n    }\n\n    if (createsStackingContext(this.dialog_.parentElement)) {\n      console.warn('A dialog is being shown inside a stacking context. ' +\n          'This may cause it to be unusable. For more information, see this link: ' +\n          'https://github.com/GoogleChrome/dialog-polyfill/#stacking-context');\n    }\n\n    this.setOpen(true);\n    this.openAsModal_ = true;\n\n    // Optionally center vertically, relative to the current viewport.\n    if (dialogPolyfill.needsCentering(this.dialog_)) {\n      dialogPolyfill.reposition(this.dialog_);\n      this.replacedStyleTop_ = true;\n    } else {\n      this.replacedStyleTop_ = false;\n    }\n\n    // Insert backdrop.\n    this.dialog_.parentNode.insertBefore(this.backdrop_, this.dialog_.nextSibling);\n\n    // Focus on whatever inside the dialog.\n    this.focus_();\n  },\n\n  /**\n   * Closes this HTMLDialogElement. This is optional vs clearing the open\n   * attribute, however this fires a 'close' event.\n   *\n   * @param {string=} opt_returnValue to use as the returnValue\n   */\n  close: function(opt_returnValue) {\n    if (!this.dialog_.hasAttribute('open')) {\n      throw new Error('Failed to execute \\'close\\' on dialog: The element does not have an \\'open\\' attribute, and therefore cannot be closed.');\n    }\n    this.setOpen(false);\n\n    // Leave returnValue untouched in case it was set directly on the element\n    if (opt_returnValue !== undefined) {\n      this.dialog_.returnValue = opt_returnValue;\n    }\n\n    // Triggering \"close\" event for any attached listeners on the <dialog>.\n    var closeEvent = new supportCustomEvent('close', {\n      bubbles: false,\n      cancelable: false\n    });\n    safeDispatchEvent(this.dialog_, closeEvent);\n  }\n\n});\n\nvar dialogPolyfill = {};\n\ndialogPolyfill.reposition = function(element) {\n  var scrollTop = document.body.scrollTop || document.documentElement.scrollTop;\n  var topValue = scrollTop + (window.innerHeight - element.offsetHeight) / 2;\n  element.style.top = Math.max(scrollTop, topValue) + 'px';\n};\n\ndialogPolyfill.isInlinePositionSetByStylesheet = function(element) {\n  for (var i = 0; i < document.styleSheets.length; ++i) {\n    var styleSheet = document.styleSheets[i];\n    var cssRules = null;\n    // Some browsers throw on cssRules.\n    try {\n      cssRules = styleSheet.cssRules;\n    } catch (e) {}\n    if (!cssRules) { continue; }\n    for (var j = 0; j < cssRules.length; ++j) {\n      var rule = cssRules[j];\n      var selectedNodes = null;\n      // Ignore errors on invalid selector texts.\n      try {\n        selectedNodes = document.querySelectorAll(rule.selectorText);\n      } catch(e) {}\n      if (!selectedNodes || !inNodeList(selectedNodes, element)) {\n        continue;\n      }\n      var cssTop = rule.style.getPropertyValue('top');\n      var cssBottom = rule.style.getPropertyValue('bottom');\n      if ((cssTop && cssTop !== 'auto') || (cssBottom && cssBottom !== 'auto')) {\n        return true;\n      }\n    }\n  }\n  return false;\n};\n\ndialogPolyfill.needsCentering = function(dialog) {\n  var computedStyle = window.getComputedStyle(dialog);\n  if (computedStyle.position !== 'absolute') {\n    return false;\n  }\n\n  // We must determine whether the top/bottom specified value is non-auto.  In\n  // WebKit/Blink, checking computedStyle.top == 'auto' is sufficient, but\n  // Firefox returns the used value. So we do this crazy thing instead: check\n  // the inline style and then go through CSS rules.\n  if ((dialog.style.top !== 'auto' && dialog.style.top !== '') ||\n      (dialog.style.bottom !== 'auto' && dialog.style.bottom !== '')) {\n    return false;\n  }\n  return !dialogPolyfill.isInlinePositionSetByStylesheet(dialog);\n};\n\n/**\n * @param {!Element} element to force upgrade\n */\ndialogPolyfill.forceRegisterDialog = function(element) {\n  if (window.HTMLDialogElement || element.showModal) {\n    console.warn('This browser already supports <dialog>, the polyfill ' +\n        'may not work correctly', element);\n  }\n  if (element.localName !== 'dialog') {\n    throw new Error('Failed to register dialog: The element is not a dialog.');\n  }\n  new dialogPolyfillInfo(/** @type {!HTMLDialogElement} */ (element));\n};\n\n/**\n * @param {!Element} element to upgrade, if necessary\n */\ndialogPolyfill.registerDialog = function(element) {\n  if (!element.showModal) {\n    dialogPolyfill.forceRegisterDialog(element);\n  }\n};\n\n/**\n * @constructor\n */\ndialogPolyfill.DialogManager = function() {\n  /** @type {!Array<!dialogPolyfillInfo>} */\n  this.pendingDialogStack = [];\n\n  var checkDOM = this.checkDOM_.bind(this);\n\n  // The overlay is used to simulate how a modal dialog blocks the document.\n  // The blocking dialog is positioned on top of the overlay, and the rest of\n  // the dialogs on the pending dialog stack are positioned below it. In the\n  // actual implementation, the modal dialog stacking is controlled by the\n  // top layer, where z-index has no effect.\n  this.overlay = document.createElement('div');\n  this.overlay.className = '_dialog_overlay';\n  this.overlay.addEventListener('click', function(e) {\n    this.forwardTab_ = undefined;\n    e.stopPropagation();\n    checkDOM([]);  // sanity-check DOM\n  }.bind(this));\n\n  this.handleKey_ = this.handleKey_.bind(this);\n  this.handleFocus_ = this.handleFocus_.bind(this);\n\n  this.zIndexLow_ = 100000;\n  this.zIndexHigh_ = 100000 + 150;\n\n  this.forwardTab_ = undefined;\n\n  if ('MutationObserver' in window) {\n    this.mo_ = new MutationObserver(function(records) {\n      var removed = [];\n      records.forEach(function(rec) {\n        for (var i = 0, c; c = rec.removedNodes[i]; ++i) {\n          if (!(c instanceof Element)) {\n            continue;\n          } else if (c.localName === 'dialog') {\n            removed.push(c);\n          }\n          removed = removed.concat(c.querySelectorAll('dialog'));\n        }\n      });\n      removed.length && checkDOM(removed);\n    });\n  }\n};\n\n/**\n * Called on the first modal dialog being shown. Adds the overlay and related\n * handlers.\n */\ndialogPolyfill.DialogManager.prototype.blockDocument = function() {\n  document.documentElement.addEventListener('focus', this.handleFocus_, true);\n  document.addEventListener('keydown', this.handleKey_);\n  this.mo_ && this.mo_.observe(document, {childList: true, subtree: true});\n};\n\n/**\n * Called on the first modal dialog being removed, i.e., when no more modal\n * dialogs are visible.\n */\ndialogPolyfill.DialogManager.prototype.unblockDocument = function() {\n  document.documentElement.removeEventListener('focus', this.handleFocus_, true);\n  document.removeEventListener('keydown', this.handleKey_);\n  this.mo_ && this.mo_.disconnect();\n};\n\n/**\n * Updates the stacking of all known dialogs.\n */\ndialogPolyfill.DialogManager.prototype.updateStacking = function() {\n  var zIndex = this.zIndexHigh_;\n\n  for (var i = 0, dpi; dpi = this.pendingDialogStack[i]; ++i) {\n    dpi.updateZIndex(--zIndex, --zIndex);\n    if (i === 0) {\n      this.overlay.style.zIndex = --zIndex;\n    }\n  }\n\n  // Make the overlay a sibling of the dialog itself.\n  var last = this.pendingDialogStack[0];\n  if (last) {\n    var p = last.dialog.parentNode || document.body;\n    p.appendChild(this.overlay);\n  } else if (this.overlay.parentNode) {\n    this.overlay.parentNode.removeChild(this.overlay);\n  }\n};\n\n/**\n * @param {Element} candidate to check if contained or is the top-most modal dialog\n * @return {boolean} whether candidate is contained in top dialog\n */\ndialogPolyfill.DialogManager.prototype.containedByTopDialog_ = function(candidate) {\n  while (candidate = findNearestDialog(candidate)) {\n    for (var i = 0, dpi; dpi = this.pendingDialogStack[i]; ++i) {\n      if (dpi.dialog === candidate) {\n        return i === 0;  // only valid if top-most\n      }\n    }\n    candidate = candidate.parentElement;\n  }\n  return false;\n};\n\ndialogPolyfill.DialogManager.prototype.handleFocus_ = function(event) {\n  var target = event.composedPath ? event.composedPath()[0] : event.target;\n\n  if (this.containedByTopDialog_(target)) { return; }\n\n  if (document.activeElement === document.documentElement) { return; }\n\n  event.preventDefault();\n  event.stopPropagation();\n  safeBlur(/** @type {Element} */ (target));\n\n  if (this.forwardTab_ === undefined) { return; }  // move focus only from a tab key\n\n  var dpi = this.pendingDialogStack[0];\n  var dialog = dpi.dialog;\n  var position = dialog.compareDocumentPosition(target);\n  if (position & Node.DOCUMENT_POSITION_PRECEDING) {\n    if (this.forwardTab_) {\n      // forward\n      dpi.focus_();\n    } else if (target !== document.documentElement) {\n      // backwards if we're not already focused on <html>\n      document.documentElement.focus();\n    }\n  }\n\n  return false;\n};\n\ndialogPolyfill.DialogManager.prototype.handleKey_ = function(event) {\n  this.forwardTab_ = undefined;\n  if (event.keyCode === 27) {\n    event.preventDefault();\n    event.stopPropagation();\n    var cancelEvent = new supportCustomEvent('cancel', {\n      bubbles: false,\n      cancelable: true\n    });\n    var dpi = this.pendingDialogStack[0];\n    if (dpi && safeDispatchEvent(dpi.dialog, cancelEvent)) {\n      dpi.dialog.close();\n    }\n  } else if (event.keyCode === 9) {\n    this.forwardTab_ = !event.shiftKey;\n  }\n};\n\n/**\n * Finds and downgrades any known modal dialogs that are no longer displayed. Dialogs that are\n * removed and immediately readded don't stay modal, they become normal.\n *\n * @param {!Array<!HTMLDialogElement>} removed that have definitely been removed\n */\ndialogPolyfill.DialogManager.prototype.checkDOM_ = function(removed) {\n  // This operates on a clone because it may cause it to change. Each change also calls\n  // updateStacking, which only actually needs to happen once. But who removes many modal dialogs\n  // at a time?!\n  var clone = this.pendingDialogStack.slice();\n  clone.forEach(function(dpi) {\n    if (removed.indexOf(dpi.dialog) !== -1) {\n      dpi.downgradeModal();\n    } else {\n      dpi.maybeHideModal();\n    }\n  });\n};\n\n/**\n * @param {!dialogPolyfillInfo} dpi\n * @return {boolean} whether the dialog was allowed\n */\ndialogPolyfill.DialogManager.prototype.pushDialog = function(dpi) {\n  var allowed = (this.zIndexHigh_ - this.zIndexLow_) / 2 - 1;\n  if (this.pendingDialogStack.length >= allowed) {\n    return false;\n  }\n  if (this.pendingDialogStack.unshift(dpi) === 1) {\n    this.blockDocument();\n  }\n  this.updateStacking();\n  return true;\n};\n\n/**\n * @param {!dialogPolyfillInfo} dpi\n */\ndialogPolyfill.DialogManager.prototype.removeDialog = function(dpi) {\n  var index = this.pendingDialogStack.indexOf(dpi);\n  if (index === -1) { return; }\n\n  this.pendingDialogStack.splice(index, 1);\n  if (this.pendingDialogStack.length === 0) {\n    this.unblockDocument();\n  }\n  this.updateStacking();\n};\n\ndialogPolyfill.dm = new dialogPolyfill.DialogManager();\ndialogPolyfill.formSubmitter = null;\ndialogPolyfill.imagemapUseValue = null;\n\n/**\n * Installs global handlers, such as click listers and native method overrides. These are needed\n * even if a no dialog is registered, as they deal with <form method=\"dialog\">.\n */\nif (window.HTMLDialogElement === undefined) {\n\n  /**\n   * If HTMLFormElement translates method=\"DIALOG\" into 'get', then replace the descriptor with\n   * one that returns the correct value.\n   */\n  var testForm = document.createElement('form');\n  testForm.setAttribute('method', 'dialog');\n  if (testForm.method !== 'dialog') {\n    var methodDescriptor = Object.getOwnPropertyDescriptor(HTMLFormElement.prototype, 'method');\n    if (methodDescriptor) {\n      // nb. Some older iOS and older PhantomJS fail to return the descriptor. Don't do anything\n      // and don't bother to update the element.\n      var realGet = methodDescriptor.get;\n      methodDescriptor.get = function() {\n        if (isFormMethodDialog(this)) {\n          return 'dialog';\n        }\n        return realGet.call(this);\n      };\n      var realSet = methodDescriptor.set;\n      /** @this {HTMLElement} */\n      methodDescriptor.set = function(v) {\n        if (typeof v === 'string' && v.toLowerCase() === 'dialog') {\n          return this.setAttribute('method', v);\n        }\n        return realSet.call(this, v);\n      };\n      Object.defineProperty(HTMLFormElement.prototype, 'method', methodDescriptor);\n    }\n  }\n\n  /**\n   * Global 'click' handler, to capture the <input type=\"submit\"> or <button> element which has\n   * submitted a <form method=\"dialog\">. Needed as Safari and others don't report this inside\n   * document.activeElement.\n   */\n  document.addEventListener('click', function(ev) {\n    dialogPolyfill.formSubmitter = null;\n    dialogPolyfill.imagemapUseValue = null;\n    if (ev.defaultPrevented) { return; }  // e.g. a submit which prevents default submission\n\n    var target = /** @type {Element} */ (ev.target);\n    if ('composedPath' in ev) {\n      var path = ev.composedPath();\n      target = path.shift() || target;\n    }\n    if (!target || !isFormMethodDialog(target.form)) { return; }\n\n    var valid = (target.type === 'submit' && ['button', 'input'].indexOf(target.localName) > -1);\n    if (!valid) {\n      if (!(target.localName === 'input' && target.type === 'image')) { return; }\n      // this is a <input type=\"image\">, which can submit forms\n      dialogPolyfill.imagemapUseValue = ev.offsetX + ',' + ev.offsetY;\n    }\n\n    var dialog = findNearestDialog(target);\n    if (!dialog) { return; }\n\n    dialogPolyfill.formSubmitter = target;\n\n  }, false);\n\n  /**\n   * Global 'submit' handler. This handles submits of `method=\"dialog\"` which are invalid, i.e.,\n   * outside a dialog. They get prevented.\n   */\n  document.addEventListener('submit', function(ev) {\n    var form = ev.target;\n    var dialog = findNearestDialog(form);\n    if (dialog) {\n      return;  // ignore, handle there\n    }\n\n    var submitter = findFormSubmitter(ev);\n    var formmethod = submitter && submitter.getAttribute('formmethod') || form.getAttribute('method');\n    if (formmethod === 'dialog') {\n      ev.preventDefault();\n    }\n  });\n\n  /**\n   * Replace the native HTMLFormElement.submit() method, as it won't fire the\n   * submit event and give us a chance to respond.\n   */\n  var nativeFormSubmit = HTMLFormElement.prototype.submit;\n  var replacementFormSubmit = function () {\n    if (!isFormMethodDialog(this)) {\n      return nativeFormSubmit.call(this);\n    }\n    var dialog = findNearestDialog(this);\n    dialog && dialog.close();\n  };\n  HTMLFormElement.prototype.submit = replacementFormSubmit;\n}\n\nexport default dialogPolyfill;\n","import { getLocations, getEvents, getTimes, getFavorites, addFavorite, removeFavorite } from '../../exports'\r\nimport { getStyles } from './getStyles'\r\nimport { clearHTML, getDateInfo, getEventId, parseHTML, search } from '../../utilities'\r\nimport { DEFAULT_BREAKPOINT, DEFAULT_EVENT, DEFAULT_TIMES } from '../../constants'\r\nimport { getActiveEvent } from './componentUtils'\r\nimport renderSortDialog from './renderSortDialog'\r\nimport renderEventDialog from './renderEventDialog'\r\nimport renderByLocation from './renderByLocation'\r\nimport renderByTime from './renderByTime'\r\nimport renderFavorites from './renderFavorites'\r\nimport renderSearchBar from './renderSearchBar'\r\nimport renderSearchResults from './renderSearchResults'\r\nimport dialogPolyfill from 'dialog-polyfill'\r\n\r\n// A native web component for the main event schedule\r\nclass ProgramGuideNative extends HTMLElement {\r\n\r\n  constructor() {\r\n\r\n    // set up basic component needs\r\n    super()\r\n    const component = this\r\n    component.root = component.attachShadow({ mode: 'open' })\r\n\r\n    // component state\r\n    component.locations = []\r\n    component.events = []\r\n    component.times = DEFAULT_TIMES\r\n    component.activeDay = ''\r\n    component.activeLocation = ''\r\n    component.activeEvent = getActiveEvent(DEFAULT_EVENT)\r\n    component.sortBy = 'location' // location | allTime | now | nowOnly | time | favorites\r\n    component.favorites = []\r\n    component.currentSearch = ''\r\n    component.searchResults = []\r\n\r\n    // use the closure for referencing `component` to avoid binding issues with `this`\r\n    component.handleEsc = event => {\r\n      if (event.key === 'Esc' || event.key === 'Escape') {\r\n        event.preventDefault()\r\n        component.toggleSortDialog(false)\r\n        component.closeEventDialog()\r\n        component.render()\r\n      }\r\n    }\r\n\r\n    // render loading spinner\r\n    component.render({ loading: true })\r\n\r\n    // asynchronously get data and render table\r\n    getLocations().then(async locations => {\r\n\r\n      // set the default active location for mobile view\r\n      component.events = await getEvents()\r\n      component.times = await getTimes()\r\n      component.favorites = await getFavorites()\r\n      component.locations = locations\r\n      component.activeLocation = locations[0]\r\n      const { days } = component.times || DEFAULT_TIMES\r\n      component.activeDay = Object.keys(days)[0]\r\n      const firstTime = days[component.activeDay][0].date\r\n      const { date, time } = getDateInfo(firstTime)\r\n      component.activeTime = new Date(`${date} ${time}`)\r\n\r\n      // initial render\r\n      component.render()\r\n    })\r\n  }\r\n\r\n  connectedCallback() {\r\n    const component = this\r\n    window.addEventListener('keydown', component.handleEsc)\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    const component = this\r\n    window.removeEventListener('keydown', component.handleEsc)\r\n  }\r\n\r\n  render({ loading } = {}) {\r\n    const component = this\r\n\r\n    // clear previously rendered content\r\n    clearHTML(component.root)\r\n\r\n    // get style\r\n    const { css, breakpoint } = component.dataset\r\n    const style = css || getStyles(breakpoint || DEFAULT_BREAKPOINT)\r\n\r\n    // render loading spinner if necessary\r\n    if (loading) {\r\n      const loadingTemplate = document.createElement('template')\r\n      loadingTemplate.innerHTML = /* html */`\r\n        <style>${style}</style>\r\n        <div class=\"pg-loading\"></div>\r\n      `\r\n      component.root.appendChild(loadingTemplate.content.cloneNode(true))\r\n      return true // success\r\n    }\r\n\r\n    // determine which render method to use\r\n    const renderMap = {\r\n      location: renderByLocation,\r\n      time: renderByTime,\r\n      allTime: renderByTime,\r\n      now: renderByTime,\r\n      nowOnly: renderByTime,\r\n      favorites: renderFavorites,\r\n      search: renderSearchResults,\r\n    }\r\n    const renderTable = renderMap[component.sortBy]\r\n\r\n    // rewrite the template HTML\r\n    const tableTemplate = document.createElement('template')\r\n    tableTemplate.innerHTML = /* html */`\r\n      <style>\r\n        /* typical browser defaults for dialog polyfill */\r\n        dialog + .backdrop { position: fixed; top: 0; right: 0; bottom: 0; left: 0; background: rgba(0, 0, 0, 0.1); }\r\n        ${style}\r\n      </style>\r\n      ${renderSearchBar(component)}\r\n      ${renderTable(component)}\r\n      <dialog class=\"pg-dialog pg-dialog--sort\">${renderSortDialog(component)}</dialog>\r\n      <dialog class=\"pg-dialog pg-dialog--event\">${renderEventDialog(component)}</dialog>\r\n    `\r\n    component.root.appendChild(tableTemplate.content.cloneNode(true))\r\n    component.registerDialogs()\r\n    return true // success\r\n  }\r\n\r\n  async addFavorite(encodedEvent) {\r\n    const component = this\r\n    const eventJSON = decodeURIComponent(encodedEvent)\r\n    const event = JSON.parse(eventJSON)\r\n    component.favorites.push(event)\r\n    component.render()\r\n    return await addFavorite(event)\r\n  }\r\n\r\n  async removeFavorite(encodedEvent) {\r\n    const component = this\r\n    const eventJSON = decodeURIComponent(encodedEvent)\r\n    const event = JSON.parse(eventJSON)\r\n    const removeIndex = component.favorites.findIndex(({ location: _location, start, name }) => {\r\n      const { location: cLocation, start: cStart, name: cName } = event\r\n      return _location === cLocation && start === cStart && name === cName\r\n    })\r\n    component.favorites.splice(removeIndex, 1)\r\n    component.render()\r\n    return await removeFavorite(event)\r\n  }\r\n\r\n  toggleHeaders({ target }) {\r\n    const component = this\r\n\r\n    // do not rerender, because it will reset the scroll\r\n    const allHeaders = component.root.querySelectorAll('.pg-cell-wrapper--row-header')\r\n    const COLLAPSED_CLASS = 'pg-cell-wrapper--row-header-collapsed'\r\n    const addOrRemove = target.classList.contains(COLLAPSED_CLASS) ? 'remove' : 'add'\r\n    for (const header of allHeaders) {\r\n      header.classList[addOrRemove](COLLAPSED_CLASS)\r\n    }\r\n\r\n    // also collapse the corner\r\n    const corner = component.root.querySelector('.pg-cell-wrapper--corner')\r\n    corner.classList[addOrRemove]('pg-cell-wrapper--corner-collapsed')\r\n  }\r\n\r\n  toggleSortDialog(_bool) {\r\n    const component = this\r\n    const bool = _bool === 'true' ? true : !!_bool\r\n    const dialog = component.root.querySelector('.pg-dialog--sort')\r\n    const dialogContent = parseHTML(renderSortDialog(component))\r\n    clearHTML(dialog)\r\n    dialog.appendChild(dialogContent)\r\n    if (bool) dialog.showModal()\r\n    else dialog.close()\r\n  }\r\n\r\n  openEventDialog(encodedEvent) {\r\n    const component = this\r\n\r\n    // set event data\r\n    const eventJSON = decodeURIComponent(encodedEvent)\r\n    const event = JSON.parse(eventJSON)\r\n    component.activeEvent = getActiveEvent(event)\r\n\r\n    // show the dialog\r\n    const dialog = component.root.querySelector('.pg-dialog--event')\r\n    const dialogContent = parseHTML(renderEventDialog(component))\r\n    clearHTML(dialog)\r\n    dialog.appendChild(dialogContent)\r\n    dialog.showModal()\r\n  }\r\n\r\n  closeEventDialog() {\r\n    const component = this\r\n    const dialog = component.root.querySelector('.pg-dialog--event')\r\n    dialog.close()\r\n  }\r\n\r\n  selectActiveLocation(_location) {\r\n    const component = this\r\n    component.sortBy = 'location'\r\n    component.activeLocation = _location\r\n    component.toggleSortDialog(false) // close upon selection\r\n    component.render()\r\n  }\r\n\r\n  selectActiveDay(event) {\r\n    const component = this\r\n    const activeDay = component.activeDay = event.target.value\r\n    const timeString = component.activeTime.toLocaleTimeString()\r\n    component.activeTime = new Date(`${activeDay} ${timeString}`)\r\n  }\r\n\r\n  selectActiveTime({ target }) {\r\n    const component = this\r\n\r\n    // validate the time and autocorrect\r\n    if (target.min > target.value) target.value = target.min\r\n    if (target.max < target.value) target.value = target.max\r\n    const { interval } = component.times || DEFAULT_TIMES\r\n    const [hr, mn] = target.value.split(':')\r\n    const roundedMn = Math.round(mn / interval) * interval\r\n    const newMn = String(roundedMn).length === 1 ? `0${roundedMn}` : roundedMn\r\n    target.value = `${hr}:${newMn}`\r\n\r\n    // set the time\r\n    const { activeDay } = component\r\n    const timeString = target.value\r\n    component.activeTime = new Date(`${activeDay} ${timeString}`)\r\n  }\r\n\r\n  selectSortBy(sortBy) {\r\n    const component = this\r\n    component.sortBy = sortBy\r\n    component.toggleSortDialog(false) // close upon selection\r\n    component.render()\r\n  }\r\n\r\n  changeSearch({ target }) {\r\n    const component = this\r\n    component.currentSearch = target.value\r\n  }\r\n\r\n  search(event) {\r\n    event.preventDefault()\r\n    const component = this\r\n    const { currentSearch, events } = component\r\n\r\n    // filter search results\r\n    component.searchResults = events.filter(event =>\r\n      search(currentSearch, event.name)\r\n      || search(currentSearch, event.location)\r\n      || search(currentSearch, event.host)\r\n      || search(currentSearch, event.category)\r\n      || search(currentSearch, event.description)\r\n    )\r\n\r\n    // sort name matches at the top\r\n    component.searchResults.sort((prev, next) => {\r\n      const prevName = search(currentSearch, prev.name)\r\n      const nextName = search(currentSearch, next.name)\r\n      return !prevName && nextName ? 1 : (prevName && !nextName ? -1 : 0)\r\n    })\r\n\r\n    // render search results\r\n    component.sortBy = 'search'\r\n    component.render()\r\n  }\r\n\r\n  registerDialogs() {\r\n    const component = this\r\n    const dialogs = component.root.querySelectorAll('.pg-dialog')\r\n    for (const dialog of dialogs) dialogPolyfill.registerDialog(dialog)\r\n  }\r\n}\r\n\r\nexport default ProgramGuideNative\r\n","import { runMethod } from '../../utilities'\r\n\r\nconst renderSearchBar = ({ currentSearch }) => /* html */`\r\n  <form class=\"pg-search-bar\" onsubmit=\"${runMethod('search')}\">\r\n    <input class=\"pg-search-input\" onchange=\"${runMethod('changeSearch')}\" placeholder=\"Search events ...\" value=\"${currentSearch}\" />\r\n    <button class=\"pg-search-button\"><i class=\"pg-search-icon\" title=\"Search\"></i></button>\r\n  </form>\r\n`\r\n\r\nexport default renderSearchBar\r\n","import * as Exports from '../lib/exports'\r\nimport * as Components from '../lib/uiComponents'\r\n\r\nexport default {\r\n  ...Exports,\r\n  Components,\r\n}\r\n"],"names":["DEFAULT_FLOOR_PLAN","title","imageSrc","clickableAreas","DEFAULT_GUIDE","events","floorPlan","DEFAULT_ADD_FAVORITE","async","favoriteEvents","JSON","parse","localStorage","getItem","push","event","eventsJSON","stringify","setItem","DEFAULT_GET_FAVORITES","DEFAULT_FETCH_DATA","Promise","resolve","guide","addFavorite","getFavorites","NOW","Date","now","DEFAULT_EVENT","start","end","location","name","host","category","description","DEFAULT_CLICKABLE_AREA","shape","coords","href","alt","DEFAULT_TIMES","days","interval","DEFAULT_BREAKPOINT","NOOP","getType","val","constructor","toLowerCase","checkType","type","validString","validArray","every","t","some","isObject","obj","useFallback","fallbackObj","onFallback","_altTypes","key","fallbackValue","valid","value","empty","altTypes","altTypesArr","mismatch","useCast","getValue","status","console","warn","Object","keys","reduce","castObj","checkFilterType","filter","after","before","locations","search","clearHTML","element","i","childNodes","length","removeChild","lastChild","parseHTML","htmlStr","range","document","createRange","selectNode","body","createContextualFragment","mapString","arr","callback","map","join","roundMinutes","_date","nearestMinute","date","roundedMinutes","Math","round","getMinutes","setMinutes","WholeNumber","num","Number","toFixed","getDay","idx","short","getDateInfo","time","toLocaleTimeString","timeStyle","day","toLocaleDateString","runMethod","args","a","encodeURIComponent","String","getEventId","_start","snip","s","replace","_input","_text","formatForSimilarMatch","str","normalize","input","text","split","trim","slice","state","_hasFetched","hasFetched","this","bool","fetchQueue","forEach","waitForFetch","removeFavorite","removeIndex","findIndex","_location","cLocation","cStart","cName","splice","add","Set","times","allTimes","earliestTime","min","latestTime","max","minutes","getTimeObject","timeString","getFullDay","prevTime","currentTime","getDate","find","getEvents","_filters","include","_include","exclude","_exclude","filters","Infinity","contains","getLocations","getTimes","init","data","castEvent","castFloorPlan","castClickableArea","getActiveEvent","getCellData","spanState","sortBy","_event","e","hasStarted","eventName","cellType","duration","getStart","span","blank","renderSortDialog","activeDay","activeTime","_activeTime","dataset","breakpoint","beyondThreshold","window","matchMedia","matches","getTimeValue","hour12","currentTimes","minTime","maxTime","step","renderEventDialog","favorites","activeEvent","existingFavorite","aLocation","aStart","aName","favoriteMethod","favoriteText","paragraph","toISOString","renderByLocation","activeLocation","getActiveClass","className","renderByTime","_times","nowDay","nowDate","nowTime","filteredTimes","nowOnly","allTime","currentDay","renderFavorites","startDate","endDate","startTime","endTime","renderSearchResults","searchResults","supportCustomEvent","CustomEvent","safeDispatchEvent","target","check","dispatchEvent","findNearestDialog","el","localName","parentElement","parentNode","safeBlur","shadowRoot","activeElement","blur","inNodeList","nodeList","node","isFormMethodDialog","hasAttribute","getAttribute","findFocusableElementWithin","hostElement","query","querySelector","Element","prototype","elems","querySelectorAll","tagName","isConnected","findFormSubmitter","submitter","form","HTMLFormElement","dialogPolyfill","formSubmitter","getRootNode","maybeHandleSubmit","defaultPrevented","imagemapUseValue","dialog","preventDefault","close","dialogPolyfillInfo","dialog_","replacedStyleTop_","openAsModal_","setAttribute","show","bind","showModal","addEventListener","returnValue","MutationObserver","maybeHideModal","observe","attributes","attributeFilter","timeout","removed","cb","downgradeModal","delayModel","ev","cand","substr","clearTimeout","setTimeout","defineProperty","set","setOpen","get","backdrop_","createElement","backdropMouseEvent_","x","createEvent","initCustomEvent","bubbles","cancelable","detail","Event","style","zIndex","top","dm","removeDialog","removeAttribute","focus","fake","insertBefore","firstChild","tabIndex","redirectedEvent","initMouseEvent","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","stopPropagation","focus_","updateZIndex","dialogZ","backdropZ","Error","open","pushDialog","getComputedStyle","invalid","k","ok","undefined","opacity","position","webkitOverflowScrolling","createsStackingContext","needsCentering","reposition","nextSibling","opt_returnValue","closeEvent","scrollTop","documentElement","topValue","innerHeight","offsetHeight","styleSheets","styleSheet","cssRules","j","rule","selectedNodes","selectorText","cssTop","getPropertyValue","cssBottom","bottom","isInlinePositionSetByStylesheet","HTMLDialogElement","forceRegisterDialog","pendingDialogStack","checkDOM","checkDOM_","overlay","forwardTab_","handleKey_","handleFocus_","zIndexLow_","zIndexHigh_","mo_","records","rec","c","removedNodes","concat","DialogManager","blockDocument","childList","subtree","unblockDocument","removeEventListener","disconnect","updateStacking","dpi","last","appendChild","containedByTopDialog_","candidate","composedPath","compareDocumentPosition","Node","DOCUMENT_POSITION_PRECEDING","keyCode","cancelEvent","indexOf","allowed","unshift","index","testForm","method","methodDescriptor","getOwnPropertyDescriptor","realGet","call","realSet","v","shift","offsetX","offsetY","nativeFormSubmit","submit","ProgramGuideNative","HTMLElement","super","component","root","attachShadow","mode","currentSearch","handleEsc","toggleSortDialog","closeEventDialog","render","loading","then","firstTime","connectedCallback","disconnectedCallback","css","getStyles","loadingTemplate","innerHTML","content","cloneNode","renderTable","tableTemplate","renderSearchBar","registerDialogs","encodedEvent","eventJSON","decodeURIComponent","toggleHeaders","allHeaders","COLLAPSED_CLASS","addOrRemove","classList","header","_bool","dialogContent","openEventDialog","selectActiveLocation","selectActiveDay","selectActiveTime","hr","mn","roundedMn","newMn","selectSortBy","changeSearch","sort","prev","next","prevName","nextName","dialogs","registerDialog","Exports","Components"],"mappings":"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"}