const e={title:"Venue",imageSrc:"",clickableAreas:[]},n={events:[],floorPlan:e},r=()=>Promise.resolve(n),o=Date.now(),t={start:o,end:o+36e5,location:"(none)",name:"(none)"},a={shape:"rect",coords:[],href:"#",alt:""},l={days:[],interval:60},c="50em",i=()=>{},d=e=>null===e?"null":"object"==typeof e?e.constructor.name.toLowerCase():typeof e,s=(e,n)=>{const r="string"===d(n),o="array"===d(n)&&n.every((e=>"string"===d(e)));if(!r&&!o)throw"`checkType()` expects either a string or array of strings in the second argument";return r?d(e)===n:o?n.some((n=>d(e)===n)):void 0},p=e=>s(e,"object"),g=(e,n=i,r={})=>{if(!p(e))throw"`useFallback()` expects an object in the first argument";if(!s(n,"function"))throw"`useFallback()` expects a function in the second argument";if(!p(r))throw"`useFallback()` expects an object in the third argument";return(o,t)=>{const a=e[t],l=p(o),c=l?o[t]:null,i=s(c,["undefined","null"]);const g=d(c),h=r[t],m=s(h,"array")?h:s(h,"string")?[h]:[],u=g!==d(a)&&!m.some((e=>e===g));if(!l||i||u){return n(l?i?"empty":"mismatch":"invalid",t),a}return c}},h=(e,n="object",r={})=>{if(!p(e))throw"You may only cast to custom object types";return o=>{if(!p(o))return e;const t=g(e,((r,t)=>{"invalid"===r?console.warn(`The provided ${n} is not a valid object.`):"mismatch"===r?console.warn(`The \`${t}\` field expected type \`${d(e[t])}\` but got \`${d(o[t])}\`.`):"empty"===r&&console.warn(`The provided ${n} did not have the \`${t}\` field.`)}),r);return Object.keys(e).reduce(((e,n)=>(e[n]=t(o,n),e)),{})}},m=(e={})=>{if("after"in e&&!s(e.after,["number","date"]))throw"The `after` field expects a number or date";if("before"in e&&!s(e.before,["number","date"]))throw"The `before` field expects a number or date";if("locations"in e&&!s(e.locations,"array"))throw"The `locations` field expects an array";if("search"in e&&!s(e.search,["string","regexp"]))throw"The `search` field expects a string or regular expression";return!0},u=(e,n)=>e.map(n).join(""),f=(e,n=15)=>{const r=new Date(e),o=Math.round(r.getMinutes()/n)*n;return r.setMinutes(o),r},v=e=>Number(e.toFixed()),b={_hasFetched:!1,get hasFetched(){return this._hasFetched},set hasFetched(e){return this._hasFetched=e,!1!==e&&(this.fetchQueue.forEach((e=>e())),!0)},fetchQueue:[],waitForFetch(){return new Promise((e=>{this.hasFetched?e():this.fetchQueue.push(e)}))},guide:n,get locations(){return[...(this.guide?.events||[]).reduce(((e,n)=>s(n,"object")&&s(n.location,"string")?(e.add(n.location),e):e),new Set)]},get times(){const e=[...(this.guide?.events||[]).reduce(((e,n)=>s(n,"object")&&s(n.start,["number","date"])&&s(n.end,["number","date"])?(e.add(f(n.start)),e.add(f(n.end)),e):e),new Set)],n=new Date(Math.min(...e)),r=new Date(Math.max(...e)),o=e.reduce(((e,n)=>{if(15!==e){const r=n.getMinutes();30===r&&(e=30),15!==r&&45!==r||(e=15)}return e}),0),t=e=>({date:e,timeString:e.toLocaleTimeString("en-US",{timeStyle:"short"})}),a=e=>`${((e,n=!1)=>n?["Sun","Mon","Tues","Wed","Thurs","Fri","Sat"][e]:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][e])(e.getDay())} ${e.toLocaleDateString()}`;let l={[a(n)]:[t(n)]},c=n;for(;c<r;){let n=null;Math.max(...e.filter((e=>e.getDate()===c.getDate())))===Number(c)?(n=new Date(e.find((e=>e>c))),l[a(n)]=[t(n)]):(n=new Date(c),n.setMinutes(n.getMinutes()+o),l[a(n)].push(t(n))),c=n}return{days:l,interval:o}}},w=async(e={})=>{if(await b.waitForFetch(),!p(e))throw"`getEvents()` expects an object in the first argument";const{include:n={},exclude:r={}}=e;m(n),m(r);const o={...e,include:{...n,after:n.after?Number(n.after):0,before:n.before?Number(n.before):1/0},exclude:{...r,after:r.after?Number(r.after):1/0,before:r.before?Number(r.before):0}},{include:t={},exclude:a={}}=o;return b.guide.events.filter((e=>!(e.start<t.after)&&(!(e.start>a.after)&&(!(e.end>t.before)&&(!(e.end<a.before)&&(!("locations"in t&&!contains(t.locations,e.location))&&((!("locations"in a)||!contains(a.locations,e.location))&&(!("search"in t&&!contains(e.name,t.search))&&(!("search"in a)||!contains(e.name,a.search))))))))))},y=async()=>(await b.waitForFetch(),b.locations),k=async()=>(await b.waitForFetch(),b.times);var x=Object.freeze({__proto__:null,fetchGuide:async(n=r)=>{const o=await n();if(!p(o))throw"`fetchGuide()` must return an object";if("events"in o){if(!s(o.events,"array"))throw"The `events` field expects an array";const e=h(t,"event",{start:"date",end:"date"});b.guide.events=o.events.map(e)}if("floorPlan"in o){if(!p(o.floorPlan))throw"The `floorPlan` field expects an object";const n=h(e,"floor plan"),r=h(a,"clickable area"),t=n(o.floorPlan);b.guide.floorPlan={...t,clickableAreas:t.clickableAreas.map(r)}}b.hasFetched=!0},getEvents:w,getLocations:y,getTimes:k,getFloorPlan:async()=>(await waitForFetch(),b.guide.floorPlan)});class $ extends HTMLElement{constructor(){super();const e=this;e.root=e.attachShadow({mode:"open"}),e.locations=[],e.events=[],e.times=l,e.activeLocation="",e.dialogOpen=!1,e.render({loading:!0}),y().then((async n=>{e.locations=n,e.activeLocation=n[0],e.events=await w(),e.times=await k(),e.render()}))}toggleDialog(e){const n=this,{breakpoint:r=c}=n.dataset,o=!window.matchMedia(`(max-width: ${r})`).matches,t="true"===e||!!e;n.dialogOpen=!o&&t,n.render()}selectActiveLocation(e){const n=this;n.activeLocation=e,n.dialogOpen=!1,n.render()}render({loading:e}={}){const n=this;(e=>{let n=e.childNodes.length;for(;n--;)e.removeChild(e.lastChild)})(n.root);const{css:r,breakpoint:o}=n.dataset,t=r||(e=>`\n  :host,\n  ::before,\n  ::after {\n    --font: sans-serif 1.5rem;\n    --font-cell: var(--font);\n    --font-header: var(--font);\n    --font-column-header: var(--font-header);\n    --font-row-header: var(--font-header);\n    --padding-cell: 1rem 2rem;\n    --padding-header: var(--padding-cell);\n    --padding-column-header: var(--padding-header);\n    --padding-row-header: var(--padding-header);\n    --color-background: midnightblue;\n    --color-cell: lightsteelblue;\n    --color-cell-empty: transparent;\n    --color-cell-content: black;\n    --color-header: steelblue;\n    --color-header-content: white;\n    --color-column-header: var(--color-header);\n    --color-column-header-content: var(--color-header-content);\n    --color-row-header: var(--color-header);\n    --color-row-header-content: var(--color-header-content);\n    --color-corner: var(--color-header);\n    --color-corner-content: var(--color-header-content);\n  }\n  .pg-table-wrapper {\n    overflow: auto;\n    max-width: 100%;\n    margin-bottom: 1rem;\n  }\n  .pg-table {\n    background-color: var(--color-background);\n    width: 100%;\n  }\n  .pg-cell-wrapper {\n    background-color: var(--color-cell);\n    font: var(--font-cell);\n    padding: var(--padding-cell);\n    text-align: center;\n  }\n  .pg-cell-wrapper--corner {\n    background-color: var(--color-corner);\n    color: var(--color-corner-content);\n  }\n  .pg-cell-wrapper--row-header {\n    background-color: var(--color-row-header);\n    color: var(--color-row-header-content);\n    font: var(--font-row-header);\n    padding: var(--padding-row-header);\n    width: 5em;\n  }\n  .pg-cell-wrapper--column-header {\n    background-color: var(--color-column-header);\n    color: var(--color-column-header-content);\n    font: var(--font-column-header);\n    padding: var(--padding-column-header);\n  }\n  .pg-cell--column-header {\n    align-items: center;\n    display: flex;\n    gap: 1em;\n    justify-content: center;\n    min-width: 8em;\n  }\n  .pg-cell-wrapper--data-empty {\n    background-color: var(--color-cell-empty);\n  }\n  .pg-loading {\n    --color-loading-primary: steelblue;\n    --color-loading-secondary: white;\n    --size-loader: 5rem;\n    height: 10rem;\n    width: 100%;\n    position: relative;\n    z-index: 1;\n  }\n  .pg-loading::before,\n  .pg-loading::after {\n    bottom: 0;\n    border-radius: 50%;\n    content: '';\n    display: block;\n    left: 0;\n    margin: auto;\n    position: absolute;\n    right: 0;\n    top: 0;\n    z-index: 2;\n  }\n  @keyframes spin {\n    from { transform: rotate(0deg); }\n    to { transform: rotate(359deg); }\n  }\n  .pg-loading::before {\n    animation: spin 1s linear infinite;\n    background-image: conic-gradient(var(--color-loading-primary), var(--color-loading-secondary));\n    border: 0.4rem solid var(--color-loading-primary);\n    height: var(--size-loader);\n    width: var(--size-loader);\n    z-index: 1;\n  }\n  .pg-loading::after {\n    background-color: var(--color-loading-primary);\n    border: 0 solid;\n    height: calc(var(--size-loader) - 1rem);\n    width: calc(var(--size-loader) - 1rem);\n    z-index: 2;\n  }\n  .pg-more-icon {\n    background-color: var(--color-header);\n    border: 0.5em solid var(--color-header-content);\n    display: none;\n    position: relative;\n    vertical-align: middle;\n    z-index: 0;\n  }\n  .pg-more-icon,\n  .pg-more-icon::before,\n  .pg-more-icon::after {\n    border-radius: 50%;\n    height: 0.25em;\n    width: 0.25em;\n  }\n  .pg-more-icon::before,\n  .pg-more-icon::after {\n    background-color: var(--color-header);\n    border: 0 solid;\n    content: '';\n    display: block;\n    position: absolute;\n    top: 0;\n    z-index: 1;\n  }\n  .pg-more-icon::before {\n    left: -0.3em;\n  }\n  .pg-more-icon::after {\n    right: -0.3em;\n  }\n  .pg-dialog {\n    background-color: var(--color-header);\n    bottom: 0;\n    color: var(--color-header-content);\n    height: 100%;\n    left: 0;\n    margin: auto;\n    max-height: 40em;\n    max-width: 40em;\n    position: fixed;\n    right: 0;\n    top: 0;\n    width: 100%;\n  }\n  .pg-dialog-header {\n    display: grid;\n    grid-template-columns: 1fr auto;\n  }\n  .pg-dialog-title {\n    margin: 0;\n  }\n  .pg-dialog-close {\n    background-color: var(--color-header-content);\n    border: 0 solid;\n    border-radius: 50%;\n    color: var(--color-header);\n    cursor: pointer;\n    font-size: 1.6rem;\n    height: 2rem;\n    width: 2rem;\n  }\n  .pg-dialog-menu {\n    display: grid;\n    gap: 0.5rem;\n    margin: 0 auto;\n    max-width: 20rem;\n    padding: 2rem;\n  }\n  .pg-dialog-menu-item {\n    background-color: var(--color-cell);\n    border: none;\n    color: var(--color-cell-content);\n    cursor: pointer;\n    padding: 1rem 0.5rem;\n  }\n  @media (max-width: ${e}) {\n    .pg-more-icon {\n      display: inline-block;\n    }\n    .pg-cell-wrapper--column-header,\n    .pg-cell-wrapper--data,\n    .pg-cell-wrapper--data-empty {\n      display: none;\n    }\n    .pg-cell-wrapper--column-header-active,\n    .pg-cell-wrapper--data-active,\n    .pg-cell-wrapper--data-empty-active {\n      display: revert;\n      min-width: none;\n    }\n    .pg-cell-wrapper--column-header {\n      cursor: pointer;\n    }\n  }\n`)(o||c);if(e){const e=document.createElement("template");return e.innerHTML=`\n        <style>${t}</style>\n        <div class="pg-loading"></div>\n      `,n.root.appendChild(e.content.cloneNode(!0)),!0}const{events:a,times:i,locations:d}=n,{days:s,interval:p}=i||l,g={},h=(e,r)=>n.activeLocation===e?r:"",m=document.createElement("template");return m.innerHTML=`\n      <style>${t}</style>\n      ${u(Object.keys(s),(e=>{const n=s[e];return`\n          <div class="pg-table-wrapper">\n            <table class="pg-table">\n              <thead class="pg-header">\n                <tr class="pg-row">\n                  <td class="pg-cell-wrapper pg-cell-wrapper--corner">\n                    <div class="pg-cell pg-cell--corner">${e}</div>\n                  </td>\n                  ${u(d,(e=>`\n                    <th class="pg-cell-wrapper pg-cell-wrapper--column-header ${h(e,"pg-cell-wrapper--column-header-active")}" onclick="this.getRootNode().host.toggleDialog(true)">\n                      <div class="pg-cell pg-cell--column-header ${h(e,"pg-cell--column-header-active")}">${e} <i class="pg-more-icon"></i></div>\n                    </th>\n                  `))}\n                </tr>\n              </thead>\n              <tbody class="pg-body">\n                ${u(n,(({date:e,timeString:n})=>`\n                  <tr class="pg-row">\n                    <th class="pg-cell-wrapper pg-cell-wrapper--row-header">\n                      <div class="pg-cell pg-cell--row-header">${n}</div>\n                    </th>\n                    ${u(d,(n=>{const{eventName:r,cellType:o,rowspan:t,blank:l}=(({events:e,rowState:n,date:r,interval:o,_location:t})=>{const a=e.find((e=>Number(e.start)===Number(r)&&e.location===t)),l=a?a.name:"",c=a?"data":"data-empty",i=a?v((a.end-a.start)/1e3/60):0,d=i?v(i/o):1,s=!!n[t];return s?--n[t]:d>1&&(n[t]=d),{eventName:l,cellType:c,rowspan:d,blank:s}})({events:a,rowState:g,date:e,interval:p,_location:n});return l?"":`\n                        <td class="pg-cell-wrapper pg-cell-wrapper--${o}  ${h(n,`pg-cell-wrapper--${o}-active`)}" rowspan="${t}">\n                          <div class="pg-cell pg-cell--${o} ${h(n,`pg-cell--${o}-active`)}">${r}</div>\n                        </td>\n                      `}))}\n                  </tr>\n                `))}\n              </tbody>\n            </table>\n          </div>\n        `}))}\n      <dialog class="pg-dialog" ${n.dialogOpen?"open":""}>\n        <header class="pg-dialog-header">\n          <h1 class="pg-dialog-title">Choose a Location...</h1>\n          <button class="pg-dialog-close" onclick="this.getRootNode().host.toggleDialog(false)">&times;</button>\n        </header>\n        <menu class="pg-dialog-menu">\n          ${u(d,(e=>`\n            <button class="pg-dialog-menu-item" onclick="this.getRootNode().host.selectActiveLocation('${e}')">${e}</button>\n          `))}\n        </menu>\n      </dialog>\n    `,n.root.appendChild(m.content.cloneNode(!0)),!0}}var F={...x,Components:Object.freeze({__proto__:null,ProgramGuideNative:$})};export{F as default};//# sourceMappingURL=thunderEvents.min.mjs.map
