const e={title:"Venue",imageSrc:"",clickableAreas:[]},n={events:[],floorPlan:e},t=()=>Promise.resolve(n),r=Date.now(),a={start:r,end:r+36e5,location:"(none)",name:"(none)"},o={shape:"rect",coords:[],href:"#",alt:""},c=()=>{},l=e=>null===e?"null":"object"==typeof e?e.constructor.name.toLowerCase():typeof e,i=(e,n)=>{const t="string"===l(n),r="array"===l(n)&&n.every((e=>"string"===l(e)));if(!t&&!r)throw"`checkType()` expects either a string or array of strings in the second argument";return t?l(e)===n:r?n.some((n=>l(e)===n)):void 0},d=e=>i(e,"object"),s=(e,n=c,t={})=>{if(!d(e))throw"`useFallback()` expects an object in the first argument";if(!i(n,"function"))throw"`useFallback()` expects a function in the second argument";if(!d(t))throw"`useFallback()` expects an object in the third argument";return(r,a)=>{const o=e[a],c=d(r),s=c?r[a]:null,h=i(s,["undefined","null"]);const p=l(s),g=t[a],u=i(g,"array")?g:i(g,"string")?[g]:[],f=p!==l(o)&&!u.some((e=>e===p));if(!c||h||f){return n(c?h?"empty":"mismatch":"invalid",a),o}return s}},h=(e,n="object",t={})=>{if(!d(e))throw"You may only cast to custom object types";return r=>{if(!d(r))return e;const a=s(e,((t,a)=>{"invalid"===t?console.warn(`The provided ${n} is not a valid object.`):"mismatch"===t?console.warn(`The \`${a}\` field expected type \`${l(e[a])}\` but got \`${l(r[a])}\`.`):"empty"===t&&console.warn(`The provided ${n} did not have the \`${a}\` field.`)}),t);return Object.keys(e).reduce(((e,n)=>(e[n]=a(r,n),e)),{})}},p=(e={})=>{if("after"in e&&!i(e.after,["number","date"]))throw"The `after` field expects a number or date";if("before"in e&&!i(e.before,["number","date"]))throw"The `before` field expects a number or date";if("locations"in e&&!i(e.locations,"array"))throw"The `locations` field expects an array";if("search"in e&&!i(e.search,["string","regexp"]))throw"The `search` field expects a string or regular expression";return!0},g=(e,n)=>e.map(n).join(""),u=(e,n=15)=>{const t=new Date(e),r=Math.round(t.getMinutes()/n)*n;return t.setMinutes(r),t},f=e=>Number(e.toFixed()),m={_hasFetched:!1,get hasFetched(){return this._hasFetched},set hasFetched(e){return this._hasFetched=e,!1!==e&&(this.fetchQueue.forEach((e=>e())),!0)},fetchQueue:[],waitForFetch(){return new Promise((e=>{this.hasFetched?e():this.fetchQueue.push(e)}))},guide:n,get locations(){return[...(this.guide?.events||[]).reduce(((e,n)=>i(n,"object")&&i(n.location,"string")?(e.add(n.location),e):e),new Set)]},get times(){const e=[...(this.guide?.events||[]).reduce(((e,n)=>i(n,"object")&&i(n.start,["number","date"])&&i(n.end,["number","date"])?(e.add(u(n.start)),e.add(u(n.end)),e):e),new Set)],n=new Date(Math.min(...e)),t=new Date(Math.max(...e)),r=e.reduce(((e,n)=>{if(15!==e){const t=n.getMinutes();30===t&&(e=30),15!==t&&45!==t||(e=15)}return e}),0),a=e=>({date:e,timeString:e.toLocaleTimeString("en-US",{timeStyle:"short"})});let o={[n.toLocaleDateString()]:[a(n)]},c=n;for(;c<t;){let n=null;Math.max(...e.filter((e=>e.getDate()===c.getDate())))===Number(c)?(n=new Date(e.find((e=>e>c))),o[n.toLocaleDateString()]=[a(n)]):(n=new Date(c),n.setMinutes(n.getMinutes()+r),o[n.toLocaleDateString()].push(a(n))),c=n}return{days:o,interval:r}}},b=async(e={})=>{if(await m.waitForFetch(),!d(e))throw"`getEvents()` expects an object in the first argument";const{include:n={},exclude:t={}}=e;p(n),p(t);const r={...e,include:{...n,after:n.after?Number(n.after):0,before:n.before?Number(n.before):1/0},exclude:{...t,after:t.after?Number(t.after):1/0,before:t.before?Number(t.before):0}},{include:a={},exclude:o={}}=r;return m.guide.events.filter((e=>!(e.start<a.after)&&(!(e.start>o.after)&&(!(e.end>a.before)&&(!(e.end<o.before)&&(!("locations"in a&&!contains(a.locations,e.location))&&((!("locations"in o)||!contains(o.locations,e.location))&&(!("search"in a&&!contains(e.name,a.search))&&(!("search"in o)||!contains(e.name,o.search))))))))))},v=async()=>(await m.waitForFetch(),m.locations),w=async()=>(await m.waitForFetch(),m.times);var y=Object.freeze({__proto__:null,fetchGuide:async(n=t)=>{const r=await n();if(!d(r))throw"`fetchGuide()` must return an object";if("events"in r){if(!i(r.events,"array"))throw"The `events` field expects an array";const e=h(a,"event",{start:"date",end:"date"});m.guide.events=r.events.map(e)}if("floorPlan"in r){if(!d(r.floorPlan))throw"The `floorPlan` field expects an object";const n=h(e,"floor plan"),t=h(o,"clickable area"),a=n(r.floorPlan);m.guide.floorPlan={...a,clickableAreas:a.clickableAreas.map(t)}}m.hasFetched=!0},getEvents:b,getLocations:v,getTimes:w,getFloorPlan:async()=>(await waitForFetch(),m.guide.floorPlan)});class x extends HTMLElement{constructor(){super();const e=this;e.root=e.attachShadow({mode:"open"}),e.activeLocation="",e.render({loading:!0}),v().then((async n=>{e.activeLocation=n[0],e.render()}))}async render({loading:e}={}){const n=this;(e=>{let n=e.childNodes.length;for(;n--;)e.removeChild(e.lastChild)})(n.root);const t=n.dataset.css||"\n  .pg-table {\n    --font: sans-serif 1.5rem;\n    --font-cell: var(--font);\n    --font-header: var(--font);\n    --font-column-header: var(--font-header);\n    --font-row-header: var(--font-header);\n    --padding-cell: 1rem 2rem;\n    --padding-header: var(--padding-cell);\n    --padding-column-header: var(--padding-header);\n    --padding-row-header: var(--padding-header);\n    --color-background: midnightblue;\n    --color-cell: lightsteelblue;\n    --color-cell-empty: transparent;\n    --color-cell-content: black;\n    --color-header: steelblue;\n    --color-header-content: white;\n    --color-column-header: var(--color-header);\n    --color-column-header-content: var(--color-header-content);\n    --color-row-header: var(--color-header);\n    --color-row-header-content: var(--color-header-content);\n    --color-corner: var(--color-header);\n    --color-corner-content: var(--color-header-content);\n    background-color: var(--color-background);\n    margin-bottom: 1rem;\n    width: 100%;\n  }\n  .pg-cell-wrapper {\n    background-color: var(--color-cell);\n    font: var(--font-cell);\n    padding: var(--padding-cell);\n    text-align: center;\n  }\n  .pg-cell-wrapper--corner {\n    background-color: var(--color-corner);\n    color: var(--color-corner-content);\n  }\n  .pg-cell-wrapper--row-header {\n    background-color: var(--color-row-header);\n    color: var(--color-row-header-content);\n    font: var(--font-row-header);\n    padding: var(--padding-row-header);\n    width: 5em;\n  }\n  .pg-cell-wrapper--column-header {\n    background-color: var(--color-column-header);\n    color: var(--color-column-header-content);\n    font: var(--font-column-header);\n    padding: var(--padding-column-header);\n  }\n  .pg-cell-wrapper--data-empty {\n    background-color: var(--color-cell-empty);\n  }\n  .pg-loading {\n    --color-loading-primary: steelblue;\n    --color-loading-secondary: white;\n    --size-loader: 5rem;\n    height: 10rem;\n    width: 100%;\n    position: relative;\n    z-index: 1;\n  }\n  .pg-loading::before,\n  .pg-loading::after {\n    bottom: 0;\n    border-radius: 50%;\n    content: '';\n    display: block;\n    left: 0;\n    margin: auto;\n    position: absolute;\n    right: 0;\n    top: 0;\n    z-index: 2;\n  }\n  @keyframes spin {\n    from { transform: rotate(0deg); }\n    to { transform: rotate(359deg); }\n  }\n  .pg-loading::before {\n    animation: spin 1s linear infinite;\n    background-image: conic-gradient(var(--color-loading-primary), var(--color-loading-secondary));\n    border: 0.4rem solid var(--color-loading-primary);\n    height: var(--size-loader);\n    width: var(--size-loader);\n    z-index: 1;\n  }\n  .pg-loading::after {\n    background-color: var(--color-loading-primary);\n    border: 0 solid;\n    height: calc(var(--size-loader) - 1rem);\n    width: calc(var(--size-loader) - 1rem);\n    z-index: 2;\n  }\n  @media (min-width: 100em) {\n    .pg-fake {\n      display: none;\n    }\n  }\n";if(e){const e=document.createElement("template");return e.innerHTML=`\n        <style>${t}</style>\n        <div class="pg-loading"></div>\n      `,n.root.appendChild(e.content.cloneNode(!0)),!0}const r=await b(),{days:a,interval:o}=await w(),c=await v(),l={},i=document.createElement("template");return i.innerHTML=`\n      <style>${t}</style>\n      ${g(Object.keys(a),(e=>{const n=a[e];return`\n          <table class="pg-table">\n            <thead class="pg-header">\n              <tr class="pg-row">\n                <td class="pg-cell-wrapper pg-cell-wrapper--corner">\n                  <div class="pg-cell pg-cell--corner">${e}</div>\n                </td>\n                ${g(c,(e=>`\n                  <th class="pg-cell-wrapper pg-cell-wrapper--column-header">\n                    <div class="pg-cell pg-cell--column-header">${e}</div>\n                  </th>\n                `))}\n              </tr>\n            </thead>\n            <tbody class="pg-body">\n              ${g(n,(({date:e,timeString:n})=>`\n                <tr class="pg-row">\n                  <th class="pg-cell-wrapper pg-cell-wrapper--row-header">\n                    <div class="pg-cell pg-cell--row-header">${n}</div>\n                  </th>\n                  ${g(c,(n=>{const{eventName:t,cellType:a,rowspan:c,blank:i}=(({events:e,rowState:n,date:t,interval:r,location:a})=>{const o=e.find((e=>Number(e.start)===Number(t)&&e.location===a)),c=o?o.name:"",l=o?"data":"data-empty",i=o?f((o.end-o.start)/1e3/60):0,d=i?f(i/r):1,s=!!n[a];return s?--n[a]:d>1&&(n[a]=d),{eventName:c,cellType:l,rowspan:d,blank:s}})({events:r,rowState:l,date:e,interval:o,location:n});return i?"":`\n                      <td class="pg-cell-wrapper pg-cell-wrapper--${a}" rowspan="${c}">\n                        <div class="pg-cell pg-cell--${a}">${t}</div>\n                      </td>\n                    `}))}\n                </tr>\n              `))}\n            </tbody>\n          </table>\n        `}))}\n    `,n.root.appendChild(i.content.cloneNode(!0)),!0}}var k={...y,Components:Object.freeze({__proto__:null,ProgramGuideNative:x})};export{k as default};//# sourceMappingURL=thunderEvents.min.mjs.map
