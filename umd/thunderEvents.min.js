!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(e="undefined"!=typeof globalThis?globalThis:e||self).ThunderEvents=n()}(this,(function(){"use strict";const e={title:"Venue",imageSrc:"",dimensions:{height:600,width:800},clickableAreas:[]},n={events:[],floorPlan:e},t="FAVORITE_EVENTS",o=async e=>{const n=JSON.parse(localStorage.getItem(t)||"[]");n.push(e);const o=JSON.stringify(n);return localStorage.setItem(t,o),n},a=async()=>JSON.parse(localStorage.getItem(t)||"[]"),r=()=>Promise.resolve({guide:n,addFavorite:o,getFavorites:a}),i=Date.now(),l={start:i,end:i+36e5,location:"(not provided)",name:"(no name)",host:"(not provided)",category:"(not provided)",description:"(no description)"},s={location:"(none)",shape:"rect",coords:[],href:"#",alt:""},c={days:[],interval:60},d="50em",p=()=>{},g=e=>null===e?"null":"object"==typeof e?e.constructor.name.toLowerCase():typeof e,m=(e,n)=>{const t="string"===g(n),o="array"===g(n)&&n.every((e=>"string"===g(e)));if(!t&&!o)throw"`checkType()` expects either a string or array of strings in the second argument";return t?g(e)===n:o?n.some((n=>g(e)===n)):void 0},h=e=>m(e,"object"),u=(e,n=p,t={})=>{if(!h(e))throw"`useFallback()` expects an object in the first argument";if(!m(n,"function"))throw"`useFallback()` expects a function in the second argument";if(!h(t))throw"`useFallback()` expects an object in the third argument";return(o,a)=>{const r=e[a],i=h(o),l=i?o[a]:null,s=m(l,["undefined","null"]);const c=g(l),d=t[a],p=m(d,"array")?d:m(d,"string")?[d]:[],u=c!==g(r)&&!p.some((e=>e===c));if(!i||s||u){return n(i?s?"empty":"mismatch":"invalid",a),r}return l}},f=(e,n="object",t={})=>{if(!h(e))throw"You may only cast to custom object types";return o=>{if(!h(o))return e;const a=u(e,((t,a)=>{"invalid"===t?console.warn(`The provided ${n} is not a valid object.`):"mismatch"===t?console.warn(`The \`${a}\` field expected type \`${g(e[a])}\` but got \`${g(o[a])}\`.`):"empty"===t&&console.warn(`The provided ${n} did not have the \`${a}\` field.`)}),t);return Object.keys(e).reduce(((e,n)=>(e[n]=a(o,n),e)),{})}},v=(e={})=>{if("after"in e&&!m(e.after,["number","date"]))throw"The `after` field expects a number or date";if("before"in e&&!m(e.before,["number","date"]))throw"The `before` field expects a number or date";if("locations"in e&&!m(e.locations,"array"))throw"The `locations` field expects an array";if("search"in e&&!m(e.search,["string","regexp"]))throw"The `search` field expects a string or regular expression";return!0},b=e=>{let n=e.childNodes.length;for(;n--;)e.removeChild(e.lastChild)},w=e=>{const n=document.createRange();return n.selectNode(document.body),n.createContextualFragment(e)},y=(e,n)=>e.map(n).join(""),k=(e,n=15)=>{const t=new Date(e),o=Math.round(t.getMinutes()/n)*n;return t.setMinutes(o),t},$=e=>Number(e.toFixed()),S=(e,n=!1)=>n?["Sun","Mon","Tues","Wed","Thurs","Fri","Sat"][e]:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][e],x=e=>{const n=new Date(e);return{time:n.toLocaleTimeString("en-US",{timeStyle:"short"}),day:S(n.getDay()),date:n.toLocaleDateString()}},D=(e,...n)=>`this.getRootNode().host.${e}(${n.length?`${[...n].map((e=>{if("event"===e||"this"===e)return e;const n=g(e),t={object:`\`${encodeURIComponent(JSON.stringify(e))}\``,string:`\`${e}\``,default:String(e)};return t[n]||t.default}))}`:"event"})`,_=({location:e,name:n,start:t})=>{const o=e=>e.replace(/[^a-zA-Z0-9]/g,""),a=new Date(t),r=`${a.toLocaleDateString()}-${a.toLocaleTimeString()}`;return`${o(e)}-${o(n)}-${o(r)}`},E=(e,n)=>{const t=e=>e?.normalize("NFD").replace(/\p{Diacritic}/gu,"").replace(/[^a-zA-Z0-9]/g,"").toLowerCase(),o=t(e),a=t(n);return-1!==a.search(o)||(-1!==o.search(a)||e.split(/\s+/g).some((e=>-1!==a.search(t(e)))))},F=e=>e.length>40?e.slice(0,36)+"...":e,T={_hasFetched:!1,get hasFetched(){return this._hasFetched},set hasFetched(e){return this._hasFetched=e,!1!==e&&(this.fetchQueue.forEach((e=>e())),!0)},fetchQueue:[],waitForFetch(){return new Promise((e=>{this.hasFetched?e():this.fetchQueue.push(e)}))},guide:n,addFavorite:o,removeFavorite:async e=>{const n=JSON.parse(localStorage.getItem(t)||"[]"),o=n.findIndex((({location:n,start:t,name:o})=>{const{location:a,start:r,name:i}=e;return n===a&&t===r&&o===i}));n.splice(o,1);const a=JSON.stringify(n);return localStorage.setItem(t,a),n},getFavorites:a,get locations(){return[...(this.guide?.events||[]).reduce(((e,n)=>m(n,"object")&&m(n.location,"string")?(e.add(n.location),e):e),new Set)]},get times(){const e=[...(this.guide?.events||[]).reduce(((e,n)=>m(n,"object")&&m(n.start,["number","date"])&&m(n.end,["number","date"])?(e.add(k(n.start)),e.add(k(n.end)),e):e),new Set)],n=new Date(Math.min(...e)),t=new Date(Math.max(...e)),o=e.reduce(((e,n)=>{if(15!==e){const t=n.getMinutes();30===t&&(e=30),15!==t&&45!==t||(e=15)}return e}),0),a=e=>({date:e,timeString:e.toLocaleTimeString("en-US",{timeStyle:"short"})}),r=e=>`${S(e.getDay())} ${e.toLocaleDateString()}`;let i={[r(n)]:[a(n)]},l=n;for(;l<t;){let n=null;Math.max(...e.filter((e=>e.getDate()===l.getDate())))===Number(l)?(n=new Date(e.find((e=>e>l))),i[r(n)]=[a(n)]):(n=new Date(l),n.setMinutes(n.getMinutes()+o),i[r(n)].push(a(n))),l=n}return{days:i,interval:o}}},M=async(e={})=>{if(await T.waitForFetch(),!h(e))throw"`getEvents()` expects an object in the first argument";const{include:n={},exclude:t={}}=e;v(n),v(t);const o={...e,include:{...n,after:n.after?Number(n.after):0,before:n.before?Number(n.before):1/0},exclude:{...t,after:t.after?Number(t.after):1/0,before:t.before?Number(t.before):0}},{include:a={},exclude:r={}}=o;return T.guide.events.filter((e=>!(e.start<a.after)&&(!(e.start>r.after)&&(!(e.end>a.before)&&(!(e.end<r.before)&&(!("locations"in a&&!contains(a.locations,e.location))&&((!("locations"in r)||!contains(r.locations,e.location))&&(!("search"in a&&!contains(e.name,a.search))&&(!("search"in r)||!contains(e.name,r.search))))))))))},L=async()=>(await T.waitForFetch(),T.locations),N=async()=>(await T.waitForFetch(),T.times),O=async()=>(await T.waitForFetch(),T.guide.floorPlan),P=async e=>await T.addFavorite(e),A=async e=>await T.removeFavorite(e),C=async()=>await T.getFavorites();var I=Object.freeze({__proto__:null,init:async(n=r)=>{const t=await n(),{guide:o}=t;if(!h(t))throw"`init()` must return an object";if(!h(o))throw"The `guide` field expects an object";if("events"in o){if(!m(o.events,"array"))throw"The `guide.events` field expects an array";const e=f(l,"event",{start:"date",end:"date"});T.guide.events=o.events.map(e)}if("floorPlan"in o){if(!h(o.floorPlan))throw"The `guide.floorPlan` field expects an object";const n=f(e,"floor plan"),t=f(s,"clickable area"),a=n(o.floorPlan);T.guide.floorPlan={...a,clickableAreas:a.clickableAreas.map(t)}}if("addFavorite"in t){if(!m(t.addFavorite,"function"))throw"The `addFavorite` field expects a function";T.addFavorite=t.addFavorite}if("removeFavorite"in t){if(!m(t.removeFavorite,"function"))throw"The `removeFavorite` field expects a function";T.removeFavorite=t.removeFavorite}if("getFavorites"in t){if(!m(t.getFavorites,"function"))throw"The `getFavorites` field expects a function";T.getFavorites=t.getFavorites}T.hasFetched=!0},addFavorite:P,removeFavorite:A,getFavorites:C,getEvents:M,getLocations:L,getTimes:N,getFloorPlan:O});const j=e=>({...e,start:new Date(e.start),end:new Date(e.end)}),z=({events:e,spanState:n,date:t,interval:o,_location:a,sortBy:r,currentTime:i})=>{const l=e.find((e=>Number(e.start)===Number(t)&&e.location===a)),s=l||e.find((e=>Number(e.end)>Number(t)&&Number(e.start)<Number(i)&&e.location===a)),c=!!s&&s.start<i,d=s?s.name:"",p=s?"data":"data-empty",g=s?$((s.end-(e=>c?i:e.start)(s))/1e3/60):0,m=g?$(g/o):1,h="location"===r?n[a]>0:n[a]>1;return h?--n[a]:m>1&&(n[a]=m),{eventName:d,cellType:p,span:m,blank:h,event:s,hasStarted:c}};const B=({locations:e,times:n,activeDay:t,activeTime:o},a="50em")=>{const r=!window.matchMedia(`(max-width: ${a})`).matches,{days:i,interval:l}=n||c,s=e=>e.toLocaleTimeString([],{hour12:!1,timeStyle:"short"}),d=s(o),p=i[t],g=s(p[0].date),m=s(p[p.length-1].date),h=60*l;return`\n    <section class="pg-dialog-body">\n      <header class="pg-dialog-header">\n        <h1 class="pg-dialog-title">Options</h1>\n        <button class="pg-dialog-close" title="Close" onclick="${D("toggleSortDialog",!1)}"><i class="pg-close-icon" title="Close"></i></button>\n      </header>\n      <section class="pg-dialog-content">\n        <menu class="pg-dialog-menu">\n          <button class="pg-dialog-menu-item" onclick="${D("selectSortBy","favorites")}">\n            <i class="pg-favorite-icon" title="View Favorites">&starf;</i>\n            <span>View Favorites</span>\n          </button>\n        </menu>\n        <menu class="pg-dialog-menu">\n          <button class="pg-dialog-menu-item" onclick="${D("showFloorPlan","none")}">\n            <span>View Floor Plan</span>\n          </button>\n        </menu>\n        <menu class="pg-dialog-menu">\n          <h2 class="pg-dialog-menu-title">Which day?</h2>\n          <select class="pg-dialog-select" onchange="${D("selectActiveDay")}">\n            ${y(Object.keys(i),(e=>`\n              <option value="${e}" ${e===t?"selected":""}>${e}</option>\n            `))}\n          </select>\n        </menu>\n        <menu class="pg-dialog-menu">\n          <h2 class="pg-dialog-menu-title">Filter by Time</h2>\n          <button class="pg-dialog-menu-item" onclick="${D("selectSortBy","allTime")}" autofocus>All Times This Day</button>\n          <button class="pg-dialog-menu-item" onclick="${D("selectSortBy","now")}">Right Now &amp; Onward</button>\n          <button class="pg-dialog-menu-item" onclick="${D("selectSortBy","nowOnly")}">Right Now Only</button>\n          <div class="pg-dialog-menu-special-item">\n            <div class="pg-dialog-menu-item pg-dialog-menu-item--input">\n              <input\n                type="time"\n                class="pg-dialog-menu-input pg-dialog-menu-input--time"\n                value="${d}"\n                min="${g}"\n                max="${m}"\n                step="${h}"\n                onchange="${D("selectActiveTime")}"\n              />\n              <span class="pg-inline-text">&amp; On</span>\n            </div>\n            <button class="pg-dialog-menu-item" onclick="${D("selectSortBy","time")}">Go &roarr;</button>\n          </div>\n        </menu>\n        <menu class="pg-dialog-menu">\n          <h2 class="pg-dialog-menu-title">Filter by Location</h2>\n          ${r?`<button class="pg-dialog-menu-item" onclick="${D("selectSortBy","location")}">All Locations</button>`:y(e,(e=>`\n              <button class="pg-dialog-menu-item" onclick="${D("selectActiveLocation",e)}">${e}</button>\n            `))}\n        </menu>\n      </section>\n    </section>\n  `},R=({favorites:e,activeEvent:n,sortBy:t})=>{const o=e.find((({location:e,start:t,name:o})=>{const{location:a,start:r,name:i}=n;return e===a&&Number(new Date(t))===Number(r)&&o===i})),a=o?"removeFavorite":"addFavorite",r=o?"Remove from Favorites":"Add to Favorites";return`\n    <article class="pg-dialog-body">\n      <header class="pg-dialog-header">\n        <h1 class="pg-dialog-title">${n.name}</h1>\n        <button class="pg-dialog-close" onclick="${D("closeEventDialog")}"><i class="pg-close-icon" title="Close"></i></button>\n      </header>\n      <section class="pg-dialog-content pg-dialog-content--text-container">\n        ${y(n.description.split(/\n/),(e=>`\n          <p class="pg-dialog-paragraph">${e}</p>\n        `))}\n      </section>\n      <footer class="pg-dialog-footer">\n        <time datetime="${n.start.toISOString()}" class="pg-time pg-time--start">\n          ${n.start.toLocaleTimeString("en-US",{timeStyle:"short"})}\n        </time>\n        to\n        <time datetime="${n.end.toISOString()}" class="pg-time pg-time--end">\n          ${n.end.toLocaleTimeString("en-US",{timeStyle:"short"})}\n        </time>\n        <div>@ ${n.location}</div>\n        <div class="pg-dialog-details">\n          <div><strong>Hosted by:</strong> <span>${n.host}</span></div>\n          <div><strong>Category:</strong> <span>${n.category}</span></div>\n        </div>\n      </footer>\n      <section class="pg-dialog-content">\n        <menu class="pg-dialog-menu">\n          <button class="pg-dialog-menu-item" onclick="${D(a,n)}" autofocus>\n            <span>${r}</span>\n            <i class="pg-favorite-icon" title="${r}">&starf;</i>\n          </button>\n          ${"favorites"===t?"":`<button class="pg-dialog-menu-item" onclick="${D("selectSortBy","favorites")}" autofocus>\n                <span>View All Favorites</span>\n                <i class="pg-favorite-icon" title="View All Favorites">&starf;</i>\n              </button>`}\n        </menu>\n      </section>\n    </article>\n  `},H=({activeLocation:e,events:n,times:t,locations:o,sortBy:a,activeDay:r,marker:i})=>{const{days:l,interval:s}=t||c,d={},p=(n,t)=>e===n?t:"",g=l[r];return`\n    <div class="pg-table-wrapper">\n      <table class="pg-table">\n        <thead class="pg-header">\n          <tr class="pg-row">\n            <td class="pg-cell-wrapper pg-cell-wrapper--corner" onclick="${D("toggleSortDialog",!0)}">\n              <div class="pg-cell pg-cell--corner"><i class="pg-more-icon" title="Options..."></i> <span class="pg-corner-text">${r}</span></div>\n            </td>\n            ${y(o,(e=>`\n              <th\n                class="\n                  pg-cell-wrapper\n                  pg-cell-wrapper--column-header\n                  pg-cell-wrapper--column-header-location\n                  ${p(e,"pg-cell-wrapper--column-header-active")}\n                  ${((e,n)=>i===e?n:"")(e,"pg-cell-wrapper--column-header-active-location")}\n                "\n                onclick="${D("showFloorPlan",e)}"\n              >\n                <div class="pg-cell pg-cell--column-header ${p(e,"pg-cell--column-header-active")}">\n                  <i class="pg-map-icon"></i>\n                  <span class="pg-inline-text">${e}</span>\n                </div>\n              </th>\n            `))}\n          </tr>\n        </thead>\n        <tbody class="pg-body">\n          ${y(g,(({date:e,timeString:t})=>`\n            <tr class="pg-row">\n              <th class="pg-cell-wrapper pg-cell-wrapper--row-header">\n                <div class="pg-cell pg-cell--row-header">${t}</div>\n              </th>\n              ${y(o,(t=>{const{eventName:o,cellType:r,span:i,blank:l,event:c}=z({events:n,spanState:d,date:e,interval:s,_location:t,sortBy:a});return l?"":`\n                  <td\n                    class="pg-cell-wrapper pg-cell-wrapper--${r} ${p(t,`pg-cell-wrapper--${r}-active`)}"\n                    rowspan="${i}"\n                    id="${c?_(c):""}"\n                    ${c?`onclick="${D("openEventDialog",c)}"`:""}\n                  >\n                    <div class="pg-cell pg-cell--${r} ${p(t,`pg-cell--${r}-active`)}">${F(o)}</div>\n                  </td>\n                `}))}\n            </tr>\n          `))}\n        </tbody>\n      </table>\n    </div>\n  `},V=({events:e,times:n,locations:t,sortBy:o,activeTime:a,activeDay:r})=>{const{days:i,interval:l}=n||c,s={},d=i[r],p=k(Date.now(),l),{day:g,date:m,time:h}=x(p),u={now:d.filter((({date:e})=>e>=p)),nowOnly:d.filter((({date:e})=>e===p)),time:d.filter((({date:e})=>e>=a)),allTime:d}[o],f=u.length?u:[{date:p,timeString:h}],v=u.length?r:`${g} ${m}`,b={now:p,nowOnly:p,time:a,allTime:new Date(0)}[o];return`\n    <div class="pg-table-wrapper">\n      <table class="pg-table">\n        <thead class="pg-header">\n          <tr class="pg-row">\n            <td class="pg-cell-wrapper pg-cell-wrapper--corner pg-cell-wrapper--corner-collapsed" onclick="${D("toggleSortDialog",!0)}">\n              <div class="pg-cell pg-cell--corner"><i class="pg-more-icon" title="Options..."></i> <span class="pg-corner-text">${v}</span></div>\n            </td>\n            ${y(f,(({date:e,timeString:n})=>`\n              <th class="pg-cell-wrapper pg-cell-wrapper--column-header pg-cell-wrapper--column-header-time ${e===p?"pg-cell-wrapper--column-header-active-time":""}">\n                <div class="pg-cell pg-cell--column-header pg-cell--column-header-time">\n                  <span>${n}</span>\n                  <div>${e===p?"(Current Time)":""}</div>\n                </div>\n              </th>\n            `))}\n          </tr>\n        </thead>\n        <tbody class="pg-body">\n          ${y(t,(n=>`\n            <tr class="pg-row">\n              <th class="pg-cell-wrapper pg-cell-wrapper--row-header pg-cell-wrapper--row-header-${"nowOnly"===o?"now":"time"} pg-cell-wrapper--row-header-collapsed" onclick="${D("toggleHeaders")}">\n                <div class="pg-cell pg-cell--row-header" onclick="${D("showFloorPlan",n)}">\n                  <i class="pg-map-icon"></i>\n                  <span class="pg-inline-text">${n}</span>\n                </div>\n              </th>\n              ${y(f,(({date:t})=>{const{eventName:a,cellType:r,span:i,blank:c,event:d,hasStarted:p}=z({events:e,spanState:s,date:t,interval:l,_location:n,sortBy:o,currentTime:b});return c?"":`\n                  <td\n                    class="pg-cell-wrapper pg-cell-wrapper--${r} pg-cell-wrapper--${r}-${"nowOnly"===o?"now":"time"} ${p?"pg-cell-wrapper--overflow":""}"\n                    colspan="${i}"\n                    id="${d?_(d):""}"\n                    ${d?`onclick="${D("openEventDialog",d)}"`:""}\n                  >\n                    <div class="pg-cell pg-cell--${r} pg-cell--${r}-${"nowOnly"===o?"now":"time"}">${F(a)}</div>\n                  </td>\n                `}))}\n            </tr>\n          `))}\n        </tbody>\n      </table>\n    </div>\n  `},q=({favorites:e})=>`\n  <div class="pg-table-wrapper">\n    <table class="pg-table">\n      <thead class="pg-header">\n        <tr class="pg-row">\n          <td class="pg-cell-wrapper pg-cell-wrapper--corner" onclick="${D("toggleSortDialog",!0)}">\n            <div class="pg-cell pg-cell--corner"><i class="pg-more-icon" title="Options..."></i> Favorites</div>\n          </td>\n        </tr>\n      </thead>\n      <tbody class="pg-body">\n        ${0===e.length?'\n              <tr class="pg-row">\n                <td class="pg-cell-wrapper pg-cell-wrapper--data pg-cell-wrapper--data-favorite">\n                  <div class="pg-cell pg-cell--data pg-cell--data-favorite">You have no favorites.</div>\n                </td>\n              </tr>\n            ':y(e,(e=>{const{start:n,end:t,name:o,location:a}=e,r=x(n),i=x(t),l=`${r.day} ${r.date}`,s=r.time,c=i.time;return`\n              <tr class="pg-row">\n                <td class="pg-cell-wrapper pg-cell-wrapper--data pg-cell-wrapper--data-favorite" onclick="${D("openEventDialog",e)}">\n                  <div class="pg-cell pg-cell--data pg-cell--data-favorite">\n                    <span class="pg-search-result-name">${F(o)}</span>\n                    <span class="pg-inline-result-details">${l}</span>\n                    <span class="pg-search-result-details">\n                      <span class="pg-inline-text">${s}</span>\n                      <span class="pg-inline-text">- ${c}</span>\n                      <span class="pg-inline-text"> @ ${a}</span>\n                    </span>\n                  </div>\n                </td>\n              </tr>\n            `}))}\n      </tbody>\n    </table>\n  </div>\n`,U=({searchResults:e})=>`\n  <div class="pg-table-wrapper">\n    <table class="pg-table">\n      <thead class="pg-header">\n        <tr class="pg-row">\n          <td class="pg-cell-wrapper pg-cell-wrapper--corner" onclick="${D("toggleSortDialog",!0)}">\n            <div class="pg-cell pg-cell--corner"><i class="pg-more-icon" title="Options..."></i> Search Results</div>\n          </td>\n        </tr>\n      </thead>\n      <tbody class="pg-body">\n        ${0===e.length?'\n              <tr class="pg-row">\n                <td class="pg-cell-wrapper pg-cell-wrapper--data pg-cell-wrapper--data-search">\n                  <div class="pg-cell pg-cell--data pg-cell--data-search">No results found.</div>\n                </td>\n              </tr>\n            ':y(e,(e=>{const{start:n,end:t,name:o,location:a}=e,r=x(n),i=x(t),l=`${r.day} ${r.date}`,s=r.time,c=i.time;return`\n              <tr class="pg-row">\n                <td class="pg-cell-wrapper pg-cell-wrapper--data pg-cell-wrapper--data-search" onclick="${D("openEventDialog",e)}">\n                  <div class="pg-cell pg-cell--data pg-cell--data-search">\n                    <span class="pg-search-result-name">${F(o)}</span>\n                    <span class="pg-inline-result-details">${l}</span>\n                    <span class="pg-search-result-details">\n                      <span class="pg-inline-text">${s}</span>\n                      <span class="pg-inline-text">- ${c}</span>\n                      <span class="pg-inline-text"> @ ${a}</span>\n                    </span>\n                  </div>\n                </td>\n              </tr>\n            `}))}\n      </tbody>\n    </table>\n  </div>\n`,K=({floorPlan:e,floorPlanInteractive:n,marker:t})=>{const{title:o,clickableAreas:a,dimensions:r}=e,{height:i,width:l}=r,s=a.length>0&&n,c="none"!==t?((e,n)=>{const t=n.find((({location:n})=>e===n)),o=t.coords.filter(((e,n)=>n%2==0)),a=t.coords.filter(((e,n)=>n%2!=0)),r=Math.min(...o),i=Math.min(...a);return[(r+Math.max(...o))/2,(i+Math.max(...a))/2]})(t,a):[],[d,p]=c;return`\n    <div class="pg-floor-plan-wrapper">\n      <header class="pg-floor-plan-header">\n        <button class="pg-floor-plan-menu-button" onclick="${D("toggleSortDialog",!0)}">\n          <i class="pg-more-icon" title="Options..."></i>\n        </button>\n        <h1 class="pg-floor-plan-title">${o}</h1>\n      </header>\n      <div class="pg-floor-plan-container">\n        <menu class="pg-floor-plan-menu">\n          <button class="pg-floor-plan-interactive-button" onclick="${D("toggleFloorPlanInteractive",null)}">\n            <i class="pg-search-icon"></i> ${n?"Fit to Screen":"Original Size"}\n          </button>\n          ${a.length>0?n?'<span class="pg-inline-text">Select an area for details.</span>':'<span class="pg-inline-text">View original size for more actions.</span>':""}\n        </menu>\n\n        ${s?`\n            <map name="floorPlan">\n              ${y(a,(({shape:e,coords:n,href:t,alt:o,location:a})=>{const r=t.startsWith(":")?`http${t}`:t.startsWith("//")?`http:${t}`:t,i=r.startsWith("http")&&new URL(r).hostname!==location.hostname;return`\n                  <area\n                    shape="${e}"\n                    coords="${n.join(",")}"\n                    href="${t}"\n                    ${i?'\n                      target="_blank"\n                      rel="noopener noreferrer"\n                    ':""}\n                    alt="${o??a}"\n                  />\n                `}))}\n            </map>`:""}\n\n        <div class="pg-floor-plan-image-wrapper ${s?"pg-floor-plan-image-wrapper--interactive":""}">\n          \x3c!-- This gets replaced by the image element stored in memory for optimization --\x3e\n          <img class="pg-floor-plan-image" height="${i}" width="${l}" />\n          ${d&&p&&s?`\n              <div class="pg-floor-plan-marker" style="--x: ${d}; --y: ${p}">\n                <i class="pg-map-icon"></i>\n              </div>`:""}\n        </div>\n      </div>\n    </div>\n  `};var J=window.CustomEvent;function W(e,n){var t="on"+n.type.toLowerCase();return"function"==typeof e[t]&&e[t](n),e.dispatchEvent(n)}function Y(e){for(;e;){if("dialog"===e.localName)return e;e=e.parentElement?e.parentElement:e.parentNode?e.parentNode.host:null}return null}function Z(e){for(;e&&e.shadowRoot&&e.shadowRoot.activeElement;)e=e.shadowRoot.activeElement;e&&e.blur&&e!==document.body&&e.blur()}function G(e,n){for(var t=0;t<e.length;++t)if(e[t]===n)return!0;return!1}function X(e){return!(!e||!e.hasAttribute("method"))&&"dialog"===e.getAttribute("method").toLowerCase()}function Q(e){var n=["button","input","keygen","select","textarea"].map((function(e){return e+":not([disabled])"}));n.push('[tabindex]:not([disabled]):not([tabindex=""])');var t=e.querySelector(n.join(", "));if(!t&&"attachShadow"in Element.prototype)for(var o=e.querySelectorAll("*"),a=0;a<o.length&&!(o[a].tagName&&o[a].shadowRoot&&(t=Q(o[a].shadowRoot)));a++);return t}function ee(e){return e.isConnected||document.body.contains(e)}function ne(e){if(e.submitter)return e.submitter;var n=e.target;if(!(n instanceof HTMLFormElement))return null;var t=ae.formSubmitter;if(!t){var o=e.target;t=("getRootNode"in o&&o.getRootNode()||document).activeElement}return t&&t.form===n?t:null}function te(e){if(!e.defaultPrevented){var n=e.target,t=ae.imagemapUseValue,o=ne(e);null===t&&o&&(t=o.value);var a=Y(n);if(a)"dialog"===(o&&o.getAttribute("formmethod")||n.getAttribute("method"))&&(e.preventDefault(),null!=t?a.close(t):a.close())}}function oe(e){if(this.dialog_=e,this.replacedStyleTop_=!1,this.openAsModal_=!1,e.hasAttribute("role")||e.setAttribute("role","dialog"),e.show=this.show.bind(this),e.showModal=this.showModal.bind(this),e.close=this.close.bind(this),e.addEventListener("submit",te,!1),"returnValue"in e||(e.returnValue=""),"MutationObserver"in window){new MutationObserver(this.maybeHideModal.bind(this)).observe(e,{attributes:!0,attributeFilter:["open"]})}else{var n,t=!1,o=function(){t?this.downgradeModal():this.maybeHideModal(),t=!1}.bind(this),a=function(a){if(a.target===e){var r="DOMNodeRemoved";t|=a.type.substr(0,r.length)===r,window.clearTimeout(n),n=window.setTimeout(o,0)}};["DOMAttrModified","DOMNodeRemoved","DOMNodeRemovedFromDocument"].forEach((function(n){e.addEventListener(n,a)}))}Object.defineProperty(e,"open",{set:this.setOpen.bind(this),get:e.hasAttribute.bind(e,"open")}),this.backdrop_=document.createElement("div"),this.backdrop_.className="backdrop",this.backdrop_.addEventListener("mouseup",this.backdropMouseEvent_.bind(this)),this.backdrop_.addEventListener("mousedown",this.backdropMouseEvent_.bind(this)),this.backdrop_.addEventListener("click",this.backdropMouseEvent_.bind(this))}J&&"object"!=typeof J||((J=function(e,n){n=n||{};var t=document.createEvent("CustomEvent");return t.initCustomEvent(e,!!n.bubbles,!!n.cancelable,n.detail||null),t}).prototype=window.Event.prototype),oe.prototype={get dialog(){return this.dialog_},maybeHideModal:function(){this.dialog_.hasAttribute("open")&&ee(this.dialog_)||this.downgradeModal()},downgradeModal:function(){this.openAsModal_&&(this.openAsModal_=!1,this.dialog_.style.zIndex="",this.replacedStyleTop_&&(this.dialog_.style.top="",this.replacedStyleTop_=!1),this.backdrop_.parentNode&&this.backdrop_.parentNode.removeChild(this.backdrop_),ae.dm.removeDialog(this))},setOpen:function(e){e?this.dialog_.hasAttribute("open")||this.dialog_.setAttribute("open",""):(this.dialog_.removeAttribute("open"),this.maybeHideModal())},backdropMouseEvent_:function(e){if(this.dialog_.hasAttribute("tabindex"))this.dialog_.focus();else{var n=document.createElement("div");this.dialog_.insertBefore(n,this.dialog_.firstChild),n.tabIndex=-1,n.focus(),this.dialog_.removeChild(n)}var t=document.createEvent("MouseEvents");t.initMouseEvent(e.type,e.bubbles,e.cancelable,window,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget),this.dialog_.dispatchEvent(t),e.stopPropagation()},focus_:function(){var e=this.dialog_.querySelector("[autofocus]:not([disabled])");!e&&this.dialog_.tabIndex>=0&&(e=this.dialog_),e||(e=Q(this.dialog_)),Z(document.activeElement),e&&e.focus()},updateZIndex:function(e,n){if(e<n)throw new Error("dialogZ should never be < backdropZ");this.dialog_.style.zIndex=e,this.backdrop_.style.zIndex=n},show:function(){this.dialog_.open||(this.setOpen(!0),this.focus_())},showModal:function(){if(this.dialog_.hasAttribute("open"))throw new Error("Failed to execute 'showModal' on dialog: The element is already open, and therefore cannot be opened modally.");if(!ee(this.dialog_))throw new Error("Failed to execute 'showModal' on dialog: The element is not in a Document.");if(!ae.dm.pushDialog(this))throw new Error("Failed to execute 'showModal' on dialog: There are too many open modal dialogs.");(function(e){for(;e&&e!==document.body;){var n=window.getComputedStyle(e),t=function(e,t){return!(void 0===n[e]||n[e]===t)};if(n.opacity<1||t("zIndex","auto")||t("transform","none")||t("mixBlendMode","normal")||t("filter","none")||t("perspective","none")||"isolate"===n.isolation||"fixed"===n.position||"touch"===n.webkitOverflowScrolling)return!0;e=e.parentElement}return!1})(this.dialog_.parentElement)&&console.warn("A dialog is being shown inside a stacking context. This may cause it to be unusable. For more information, see this link: https://github.com/GoogleChrome/dialog-polyfill/#stacking-context"),this.setOpen(!0),this.openAsModal_=!0,ae.needsCentering(this.dialog_)?(ae.reposition(this.dialog_),this.replacedStyleTop_=!0):this.replacedStyleTop_=!1,this.dialog_.parentNode.insertBefore(this.backdrop_,this.dialog_.nextSibling),this.focus_()},close:function(e){if(!this.dialog_.hasAttribute("open"))throw new Error("Failed to execute 'close' on dialog: The element does not have an 'open' attribute, and therefore cannot be closed.");this.setOpen(!1),void 0!==e&&(this.dialog_.returnValue=e);var n=new J("close",{bubbles:!1,cancelable:!1});W(this.dialog_,n)}};var ae={reposition:function(e){var n=document.body.scrollTop||document.documentElement.scrollTop,t=n+(window.innerHeight-e.offsetHeight)/2;e.style.top=Math.max(n,t)+"px"},isInlinePositionSetByStylesheet:function(e){for(var n=0;n<document.styleSheets.length;++n){var t=document.styleSheets[n],o=null;try{o=t.cssRules}catch(e){}if(o)for(var a=0;a<o.length;++a){var r=o[a],i=null;try{i=document.querySelectorAll(r.selectorText)}catch(e){}if(i&&G(i,e)){var l=r.style.getPropertyValue("top"),s=r.style.getPropertyValue("bottom");if(l&&"auto"!==l||s&&"auto"!==s)return!0}}}return!1},needsCentering:function(e){return"absolute"===window.getComputedStyle(e).position&&(!("auto"!==e.style.top&&""!==e.style.top||"auto"!==e.style.bottom&&""!==e.style.bottom)&&!ae.isInlinePositionSetByStylesheet(e))},forceRegisterDialog:function(e){if((window.HTMLDialogElement||e.showModal)&&console.warn("This browser already supports <dialog>, the polyfill may not work correctly",e),"dialog"!==e.localName)throw new Error("Failed to register dialog: The element is not a dialog.");new oe(e)},registerDialog:function(e){e.showModal||ae.forceRegisterDialog(e)},DialogManager:function(){this.pendingDialogStack=[];var e=this.checkDOM_.bind(this);this.overlay=document.createElement("div"),this.overlay.className="_dialog_overlay",this.overlay.addEventListener("click",function(n){this.forwardTab_=void 0,n.stopPropagation(),e([])}.bind(this)),this.handleKey_=this.handleKey_.bind(this),this.handleFocus_=this.handleFocus_.bind(this),this.zIndexLow_=1e5,this.zIndexHigh_=100150,this.forwardTab_=void 0,"MutationObserver"in window&&(this.mo_=new MutationObserver((function(n){var t=[];n.forEach((function(e){for(var n,o=0;n=e.removedNodes[o];++o)n instanceof Element&&("dialog"===n.localName&&t.push(n),t=t.concat(n.querySelectorAll("dialog")))})),t.length&&e(t)})))}};if(ae.DialogManager.prototype.blockDocument=function(){document.documentElement.addEventListener("focus",this.handleFocus_,!0),document.addEventListener("keydown",this.handleKey_),this.mo_&&this.mo_.observe(document,{childList:!0,subtree:!0})},ae.DialogManager.prototype.unblockDocument=function(){document.documentElement.removeEventListener("focus",this.handleFocus_,!0),document.removeEventListener("keydown",this.handleKey_),this.mo_&&this.mo_.disconnect()},ae.DialogManager.prototype.updateStacking=function(){for(var e,n=this.zIndexHigh_,t=0;e=this.pendingDialogStack[t];++t)e.updateZIndex(--n,--n),0===t&&(this.overlay.style.zIndex=--n);var o=this.pendingDialogStack[0];o?(o.dialog.parentNode||document.body).appendChild(this.overlay):this.overlay.parentNode&&this.overlay.parentNode.removeChild(this.overlay)},ae.DialogManager.prototype.containedByTopDialog_=function(e){for(;e=Y(e);){for(var n,t=0;n=this.pendingDialogStack[t];++t)if(n.dialog===e)return 0===t;e=e.parentElement}return!1},ae.DialogManager.prototype.handleFocus_=function(e){var n=e.composedPath?e.composedPath()[0]:e.target;if(!this.containedByTopDialog_(n)&&document.activeElement!==document.documentElement&&(e.preventDefault(),e.stopPropagation(),Z(n),void 0!==this.forwardTab_)){var t=this.pendingDialogStack[0];return t.dialog.compareDocumentPosition(n)&Node.DOCUMENT_POSITION_PRECEDING&&(this.forwardTab_?t.focus_():n!==document.documentElement&&document.documentElement.focus()),!1}},ae.DialogManager.prototype.handleKey_=function(e){if(this.forwardTab_=void 0,27===e.keyCode){e.preventDefault(),e.stopPropagation();var n=new J("cancel",{bubbles:!1,cancelable:!0}),t=this.pendingDialogStack[0];t&&W(t.dialog,n)&&t.dialog.close()}else 9===e.keyCode&&(this.forwardTab_=!e.shiftKey)},ae.DialogManager.prototype.checkDOM_=function(e){this.pendingDialogStack.slice().forEach((function(n){-1!==e.indexOf(n.dialog)?n.downgradeModal():n.maybeHideModal()}))},ae.DialogManager.prototype.pushDialog=function(e){var n=(this.zIndexHigh_-this.zIndexLow_)/2-1;return!(this.pendingDialogStack.length>=n)&&(1===this.pendingDialogStack.unshift(e)&&this.blockDocument(),this.updateStacking(),!0)},ae.DialogManager.prototype.removeDialog=function(e){var n=this.pendingDialogStack.indexOf(e);-1!==n&&(this.pendingDialogStack.splice(n,1),0===this.pendingDialogStack.length&&this.unblockDocument(),this.updateStacking())},ae.dm=new ae.DialogManager,ae.formSubmitter=null,ae.imagemapUseValue=null,void 0===window.HTMLDialogElement){var re=document.createElement("form");if(re.setAttribute("method","dialog"),"dialog"!==re.method){var ie=Object.getOwnPropertyDescriptor(HTMLFormElement.prototype,"method");if(ie){var le=ie.get;ie.get=function(){return X(this)?"dialog":le.call(this)};var se=ie.set;ie.set=function(e){return"string"==typeof e&&"dialog"===e.toLowerCase()?this.setAttribute("method",e):se.call(this,e)},Object.defineProperty(HTMLFormElement.prototype,"method",ie)}}document.addEventListener("click",(function(e){if(ae.formSubmitter=null,ae.imagemapUseValue=null,!e.defaultPrevented){var n=e.target;if("composedPath"in e)n=e.composedPath().shift()||n;if(n&&X(n.form)){if(!("submit"===n.type&&["button","input"].indexOf(n.localName)>-1)){if("input"!==n.localName||"image"!==n.type)return;ae.imagemapUseValue=e.offsetX+","+e.offsetY}Y(n)&&(ae.formSubmitter=n)}}}),!1),document.addEventListener("submit",(function(e){var n=e.target;if(!Y(n)){var t=ne(e);"dialog"===(t&&t.getAttribute("formmethod")||n.getAttribute("method"))&&e.preventDefault()}}));var ce=HTMLFormElement.prototype.submit;HTMLFormElement.prototype.submit=function(){if(!X(this))return ce.call(this);var e=Y(this);e&&e.close()}}const de=({state:e,component:n})=>async({loading:t}={})=>{const{root:o,dataset:a,templateCache:r}=n;await new Promise((e=>{setTimeout((()=>{e()}))})),b(o);const{css:i,breakpoint:l}=a,s=i||(e=>`\n\n:host {\n\n  /* general fonts */\n  --font: inherit;\n  --font-secondary: var(--font);\n\n  /* specific fonts */\n  --font-header: var(--font);\n  --font-content: var(--font-secondary);\n  --font-column-header: var(--font-header);\n  --font-row-header: var(--font-header);\n\n  /* padding */\n  --padding-cell: 1rem 2rem;\n  --padding-header: var(--padding-cell);\n  --padding-column-header: var(--padding-header);\n  --padding-row-header: var(--padding-header);\n\n  /* general colors */\n  --color-primary: lightsteelblue;\n  --color-primary-contrast: black;\n  --color-secondary: steelblue;\n  --color-secondary-contrast: white;\n  --color-tertiary: midnightblue;\n  --color-tertiary-contrast: white;\n\n  /* specific colors */\n  --color-background: var(--color-tertiary);\n  --color-foreground: var(--color-tertiary-contrast);\n  --color-cell: var(--color-primary);\n  --color-empty: transparent;\n  --color-content: var(--color-primary-contrast);\n  --color-header: var(--color-secondary);\n  --color-header-content: var(--color-secondary-contrast);\n  --color-column-header: var(--color-header);\n  --color-column-header-content: var(--color-header-content);\n  --color-row-header: var(--color-header);\n  --color-row-header-content: var(--color-header-content);\n  --color-corner: var(--color-header);\n  --color-corner-content: var(--color-header-content);\n}\n\n/* remove browser defaults so fonts can be fully customized */\n:host, button, input {\n  font-family: var(--font-secondary);\n  font-size: inherit;\n}\n\n\n.pg-search-bar {\n  background-color: var(--color-background);\n  display: grid;\n  gap: 0.2rem;\n  grid-template-columns: 1fr auto;\n  margin: 0;\n  padding: 0.2rem 0.2rem 0;\n}\n.pg-search-icon {\n  border: 0.2rem solid;\n  border-radius: 50%;\n  display: block;\n  height: 0.8rem;\n  position: relative;\n  transform: translate(-0.15rem, -0.1rem);\n  width: 0.8rem;\n}\n.pg-search-icon:after {\n  background-color: var(--color-content);\n  bottom: -0.2rem;\n  content: '';\n  display: block;\n  height: 0.2rem;\n  width: 0.5rem;\n  position: absolute;\n  right: -0.4rem;\n  transform: rotate(45deg);\n}\n.pg-search-input,\n.pg-search-button {\n  align-items: center;\n  background-color: var(--color-cell);\n  border: none;\n  box-shadow: 0 0 1.2rem rgba(0, 0, 0, 0.5);\n  color: var(--color-content);\n  cursor: pointer;\n  display: flex;\n  gap: 0.5rem;\n  justify-content: center;\n  padding: 1rem 0.5rem;\n}\n.pg-search-input {\n  cursor: text;\n}\n.pg-search-input,\n.pg-search-button {\n  padding: 0.5rem 1rem;\n}\n.pg-search-input {\n  min-width: 0;\n}\n\n\n.pg-table-wrapper {\n  background-color: var(--color-background);\n  overflow: auto;\n  max-width: 100%;\n  margin-bottom: 1rem;\n  position: relative;\n}\n.pg-table {\n  width: 100%;\n}\n.pg-cell-wrapper {\n  background-color: var(--color-cell);\n  font-family: var(--font-content);\n  padding: var(--padding-cell);\n  position: relative;\n  text-align: center;\n}\n.pg-cell-wrapper--overflow:before {\n  content: '\\2039';\n  font-size: 2.5rem;\n  position: absolute;\n  left: 0;\n  top: 0;\n  bottom: 0;\n  margin: auto;\n  line-height: 2.5rem;\n}\n.pg-cell-wrapper--corner {\n  background-color: var(--color-corner);\n  color: var(--color-corner-content);\n  cursor: pointer;\n}\n.pg-cell-wrapper--row-header {\n  background-color: var(--color-row-header);\n  color: var(--color-row-header-content);\n  font-family: var(--font-row-header);\n  padding: var(--padding-row-header);\n  text-align: right;\n}\n.pg-cell-wrapper--row-header,\n.pg-cell-wrapper--corner {\n  border-right: 0.1rem solid var(--color-background);\n  left: 0;\n  position: sticky;\n  width: 0; /* columns size to the minimum width */\n  z-index: 1;\n}\n.pg-cell--corner,\n.pg-cell--row-header {\n  width: 9rem;\n}\n.pg-cell--row-header {\n  cursor: pointer;\n  user-select: none;\n}\n.pg-cell-wrapper--row-header .pg-cell {\n  align-items: center;\n  display: grid;\n  gap: 0.5rem;\n  grid-template-columns: auto 1fr;\n}\n.pg-cell--data {\n  position: sticky;\n  left: 14rem;\n  margin: auto;\n  width: fit-content;\n  z-index: 0;\n}\n.pg-cell--data-search,\n.pg-cell--data-favorite {\n  display: grid;\n  left: 0;\n  justify-content: center;\n  margin: auto;\n}\n.pg-search-result-name {\n  font-weight: bold;\n  padding-bottom: 0.8rem;\n}\n.pg-inline-text {\n  display: inline-block;\n}\n.pg-cell--corner {\n  align-items: center;\n  display: grid;\n  gap: 0.5rem;\n  grid-template-columns: auto auto;\n  justify-content: center;\n  margin: auto;\n}\n.pg-cell-wrapper--column-header {\n  background-color: var(--color-column-header);\n  color: var(--color-column-header-content);\n  font-family: var(--font-column-header);\n  padding: var(--padding-column-header);\n}\n.pg-cell-wrapper--column-header-location {\n  cursor: pointer;\n}\n.pg-cell-wrapper--column-header-active-location,\n.pg-cell-wrapper--column-header-active-time {\n  filter: brightness(1.3);\n}\n.pg-cell-wrapper--column-header-active-time > .pg-cell {\n  display: grid;\n  gap: 0;\n}\n.pg-cell--column-header {\n  align-items: center;\n  display: flex;\n  gap: 1rem;\n  justify-content: center;\n  min-width: 8rem;\n}\n.pg-cell-wrapper--data {\n  cursor: pointer;\n}\n.pg-cell-wrapper--data-empty {\n  background-color: var(--color-empty);\n}\n.pg-time {\n  display: inline-block;\n  font-weight: bold;\n}\n\n\n.pg-favorite-icon {\n  font-size: 2rem;\n  font-style: normal;\n  line-height: 2rem;\n}\n.pg-more-icon {\n  background-color: var(--color-header);\n  border: 0.8rem solid var(--color-header-content);\n  display: block;\n  position: relative;\n  vertical-align: middle;\n  z-index: 0;\n}\n.pg-more-icon,\n.pg-more-icon:before,\n.pg-more-icon:after {\n  border-radius: 50%;\n  height: 0.4rem;\n  width: 0.4rem;\n}\n.pg-more-icon:before,\n.pg-more-icon:after {\n  background-color: var(--color-header);\n  border: 0 solid;\n  content: '';\n  display: block;\n  position: absolute;\n  top: 0;\n  z-index: 1;\n}\n.pg-more-icon:before {\n  left: -0.5rem;\n}\n.pg-more-icon:after {\n  right: -0.5rem;\n}\n.pg-close-icon {\n  height: 100%;\n  display: block;\n  position: relative;\n  width: 100%;\n}\n.pg-close-icon:before,\n.pg-close-icon:after {\n  background-color: var(--color-header);\n  bottom: 0;\n  content: '';\n  display: block;\n  height: 1.3rem;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n  width: 0.2rem;\n}\n.pg-close-icon:before {\n  transform: rotate(45deg);\n}\n.pg-close-icon:after {\n  transform: rotate(-45deg);\n}\n.pg-map-icon {\n  --color: var(--color-header-content);\n  display: inline-block;\n  height: 1.5rem;\n  width: 1.5rem;\n  margin-bottom: 0.5rem;\n  position: relative;\n  vertical-align: middle;\n  z-index: 0;\n}\n.pg-map-icon:before {\n  border: 0.37rem solid var(--color);\n  border-radius: 50%;\n  content: '';\n  display: block;\n  height: 0.75rem;\n  left: 0;\n  position: absolute;\n  top: 0;\n  width: 0.75rem;\n  z-index: 1;\n}\n.pg-map-icon:after {\n  border: 0.5rem solid var(--color);\n  border-top-color: transparent;\n  border-left-color: transparent;\n  border-radius: 20%;\n  bottom: 0;\n  content: '';\n  display: block;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n  transform: translateY(0.3rem) scaleX(0.7) rotate(45deg);\n  z-index: 0;\n}\n\n\n.pg-dialog {\n  background-color: var(--color-header);\n  bottom: 0;\n  border: 0 solid;\n  border-radius: 0.5rem;\n  box-shadow: 0 0 1rem rgba(0, 0, 0, 0.5);\n  box-sizing: border-box;\n  color: var(--color-header-content);\n  height: max-content;\n  left: 0;\n  margin: auto;\n  max-height: 100vh;\n  max-width: 40rem;\n  min-height: 40rem;\n  position: fixed;\n  right: 0;\n  top: 0;\n  width: calc(100% - 0.5rem);\n  z-index: 2;\n}\n.pg-dialog + .backdrop {\n  background-color: rgba(0, 0, 0, 0.8);\n}\n/* ::backdrop must be kept separate because of safari */\n.pg-dialog::backdrop {\n  background-color: rgba(0, 0, 0, 0.8);\n}\n.pg-dialog-header {\n  display: grid;\n  grid-template-columns: 1fr auto;\n}\n.pg-dialog-title {\n  margin: 0;\n}\n.pg-dialog-details {\n  padding-top: 1rem;\n}\n.pg-dialog-select {\n  border: 0 solid;\n  border-radius: 0.3rem;\n  padding: 0.5rem;\n}\n.pg-dialog-close {\n  align-items: center;\n  background-color: var(--color-header-content);\n  border: 0 solid;\n  border-radius: 50%;\n  color: var(--color-header);\n  cursor: pointer;\n  display: flex;\n  height: 2rem;\n  justify-content: center;\n  width: 2rem;\n}\n.pg-dialog-menu {\n  display: grid;\n  gap: 0.5rem;\n  margin: 0 auto;\n  max-width: 30rem;\n  padding: 2rem 2rem 0;\n}\n.pg-dialog-menu-title {\n  width: max-content;\n  margin: 0 auto;\n}\n.pg-dialog-menu-item {\n  align-items: center;\n  background-color: var(--color-cell);\n  border: none;\n  box-shadow: 0 0 1.2rem rgba(0, 0, 0, 0.5);\n  color: var(--color-content);\n  cursor: pointer;\n  display: flex;\n  gap: 0.5rem;\n  justify-content: center;\n  padding: 1rem 0.5rem;\n}\n.pg-dialog-menu-item--input,\n.pg-dialog-menu-input {\n  cursor: text;\n}\n.pg-dialog-menu-input {\n  background-color: transparent;\n  border: none;\n}\n.pg-dialog-menu-input--time {\n  width: 10.2rem;\n}\n.pg-dialog-menu-special-item {\n  display: grid;\n  gap: 0.5rem;\n  grid-template-columns: 2fr 1fr;\n}\n.pg-dialog-body {\n  display: grid;\n  grid-auto-rows: auto;\n  grid-template-rows: auto minmax(0, 1fr);\n  height: 100%;\n  max-height: calc(100vh - 2rem);\n  min-height: 38rem;\n  overflow: hidden;\n  position: relative;\n}\n.pg-dialog-body:before,\n.pg-dialog-body:after {\n  content: '\\02771';\n  color: var(--color-header);\n  display: inline-block;\n  font-size: 3rem;\n  height: 3rem;\n  left: 0;\n  line-height: 3rem;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  width: 3rem;\n}\n.pg-dialog-body:before {\n  top: 1rem;\n  transform: rotate(-90deg);\n}\n.pg-dialog-body:after {\n  bottom: -1.8rem;\n  transform: rotate(90deg);\n}\n.pg-dialog-content {\n  overflow: auto;\n  padding-bottom: 2rem;\n}\n.pg-dialog-content--text-container,\n.pg-dialog-footer {\n  background-color: var(--color-cell);\n  border: 0 solid;\n  border-radius: 0.5rem;\n  color: var(--color-content);\n  margin: 2rem 0 0;\n  text-align: center;\n}\n.pg-dialog-content--text-container:after {\n  background-image: linear-gradient(transparent, var(--color-cell) 90%);\n  bottom: -2rem;\n  content: '';\n  display: block;\n  height: 4rem;\n  left: 0;\n  position: sticky;\n  width: 100%;\n}\n.pg-dialog-paragraph {\n  margin: 0;\n  padding: 1rem;\n}\n.pg-dialog-footer {\n  padding: 1rem;\n}\n\n\n.pg-floor-plan-wrapper {\n  background-color: var(--color-background);\n  margin-bottom: 1rem;\n}\n.pg-floor-plan-header {\n  background-color: var(--color-header);\n  border: 0.2rem solid var(--color-background);\n  display: grid;\n  grid-template-columns: auto 1fr;\n}\n.pg-floor-plan-menu-button {\n  border: 0 solid;\n  background-color: transparent;\n  cursor: pointer;\n  padding: 1rem 1.3rem;\n}\n.pg-floor-plan-title {\n  color: var(--color-header-content);\n  margin: 0;\n  padding: 1rem;\n  text-align: right;\n}\n.pg-floor-plan-container {\n  overflow: auto;\n  padding: 0rem 0.2rem 0.2rem;\n  position: relative;\n}\n.pg-floor-plan-image-wrapper {\n  margin: 0 auto;\n  position: relative;\n  width: 100%;\n}\n.pg-floor-plan-image {\n  display: block;\n  margin: 0 auto;\n  object-fit: contain;\n  width: 100%;\n  height: auto;\n}\n.pg-floor-plan-image-wrapper--interactive {\n  width: min-content;\n}\n.pg-floor-plan-image--interactive {\n  width: unset;\n  height: unset;\n}\n.pg-floor-plan-marker {\n  --x: 0;\n  --y: 0;\n  align-items: center;\n  background-image: radial-gradient(white 25%, rgba(255, 0, 0, 0.2) 25%);\n  border: 0.1rem solid red;\n  border-radius: 50%;\n  display: grid;\n  left: var(--x);\n  pointer-events: none;\n  position: absolute;\n  top: var(--y);\n  transform: translate(-50%, -50%);\n  height: 8rem;\n  justify-items: center;\n  width: 8rem;\n}\n.pg-floor-plan-marker > .pg-map-icon {\n  --color: red;\n}\n.pg-floor-plan-menu {\n  align-items: center;\n  color: var(--color-foreground);\n  display: grid;\n  gap: 1rem;\n  justify-content: center;\n  left: 0;\n  margin: 0 auto;\n  max-width: 50rem;\n  padding: 1rem 2rem;\n  position: sticky;\n  top: 0;\n  right: 0;\n}\n.pg-floor-plan-interactive-button {\n  align-items: center;\n  background-color: var(--color-cell);\n  border: none;\n  box-shadow: 0 0 1.2rem rgba(0, 0, 0, 0.5);\n  color: var(--color-content);\n  cursor: pointer;\n  display: flex;\n  gap: 0.5rem;\n  justify-content: center;\n  padding: 1rem 2rem;\n}\n\n\n/* apply mobiles styles within the provided breakpoint */\n@media (max-width: ${e}) {\n  \n.pg-cell-wrapper--column-header,\n.pg-cell-wrapper--data,\n.pg-cell-wrapper--data-empty {\n  display: none;\n}\n.pg-cell-wrapper--column-header-active,\n.pg-cell-wrapper--column-header-time,\n.pg-cell-wrapper--data-active,\n.pg-cell-wrapper--data-time,\n.pg-cell-wrapper--data-favorite,\n.pg-cell-wrapper--data-search,\n.pg-cell-wrapper--data-empty-time,\n.pg-cell-wrapper--data-empty-active {\n  filter: none;\n  display: revert;\n  min-width: 0;\n}\n.pg-cell--data {\n  margin: 0;\n}\n.pg-cell--data-search,\n.pg-cell--data-favorite {\n  margin: auto;\n}\n.pg-cell-wrapper--corner,\n.pg-cell-wrapper--row-header-time,\n.pg-cell-wrapper--row-header-time:after {\n  transition: all 0.5s;\n}\n.pg-table-wrapper--scrolled .pg-cell-wrapper--row-header-time {\n  cursor: pointer;\n}\n.pg-table-wrapper--scrolled .pg-cell-wrapper--row-header-time:after {\n  bottom: 0;\n  content: '\\25C0';\n  display: inline-block;\n  font-size: 1rem;\n  height: 1rem;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n.pg-table-wrapper--scrolled .pg-cell-wrapper--corner-collapsed,\n.pg-table-wrapper--scrolled .pg-cell-wrapper--row-header-collapsed {\n  left: -9.5rem;\n}\n.pg-table-wrapper--scrolled .pg-cell-wrapper--row-header-collapsed:after {\n  transform: rotate(180deg);\n}\n.pg-table-wrapper--scrolled .pg-cell-wrapper--row-header-collapsed .pg-cell--row-header {\n  pointer-events: none;\n}\n.pg-table-wrapper--scrolled .pg-cell-wrapper--corner-collapsed {\n  padding-right: 0;\n}\n.pg-table-wrapper--scrolled .pg-cell-wrapper--corner-collapsed .pg-corner-text {\n  order: -1;\n}\n\n}\n`)(l||d);if(t){const e=document.createElement("template");return e.innerHTML=`\n      <style>${s}</style>\n      <div class="pg-loading"></div>\n    `,o.appendChild(e.content.cloneNode(!0)),!0}const c={location:H,time:V,allTime:V,now:V,nowOnly:V,favorites:q,search:U}[e.sortBy],p="floorPlan"===e.view,g=document.createElement("template");g.innerHTML=`\n    <style>\n      /* typical browser defaults for dialog polyfill */\n      dialog + .backdrop { position: fixed; top: 0; right: 0; bottom: 0; left: 0; background: rgba(0, 0, 0, 0.1); }\n      ${s}\n    </style>\n    <section id="ProgramGuide">\n      ${(({currentSearch:e})=>`\n  <form class="pg-search-bar" onsubmit="${D("search")}">\n    <input class="pg-search-input" onchange="${D("changeSearch")}" placeholder="Search events ..." value="${e}" />\n    <button class="pg-search-button"><i class="pg-search-icon" title="Search"></i></button>\n  </form>\n`)(e)}\n      ${p?K(e):c(e)}\n    </section>\n    <dialog class="pg-dialog pg-dialog--sort">${B(e,l)}</dialog>\n    <dialog class="pg-dialog pg-dialog--event">${R(e)}</dialog>\n  `,o.appendChild(g.content.cloneNode(!0));const m=o.querySelectorAll(".pg-dialog");for(const e of m)ae.registerDialog(e);if("guide"===e.view){const e=o.querySelector(".pg-table-wrapper"),n=()=>{const n="pg-table-wrapper--scrolled";e.scrollLeft>0&&!e.classList.contains(n)&&e.classList.add(n),0===e.scrollLeft&&e.classList.remove(n)};e.addEventListener("scroll",n)}else if("floorPlan"===e.view){o.querySelector(".pg-floor-plan-image").replaceWith(r.floorPlanImage)}return!0};var pe=({state:e,setState:n,component:t})=>async o=>{const{openEventDialog:a}=t,r=decodeURIComponent(o),i=JSON.parse(r);return n({favorites:[...e.favorites,i]},{render:!1}),a(o),await P(i)},ge=({state:e,setState:n,component:t})=>async o=>{const{openEventDialog:a}=t,r=decodeURIComponent(o),i=JSON.parse(r),l=e.favorites.findIndex((({location:e,start:n,name:t})=>{const{location:o,start:a,name:r}=i;return e===o&&n===a&&t===r})),s=[...e.favorites];return s.splice(l,1),"favorites"===e.sortBy?n({favorites:s}):(n({favorites:s},{render:!1}),a(o)),await A(i)},me=({component:e})=>n=>{const{toggleSortDialog:t,closeEventDialog:o}=e;"Esc"!==n.key&&"Escape"!==n.key||(n.preventDefault(),t(!1),o())},he=({setState:e,component:n})=>()=>{const{root:t}=n,o=location.hash.replace("#","");if(!o.startsWith("View-Location-"))return;const a=o.replace("View-Location-","").replace("-"," ");e({activeLocation:a,marker:a,view:"guide",sortBy:"location"}),history.replaceState({},"",location.href.replace(/#.+/,""));const r=t.querySelector("pg-cell-wrapper--column-header-active-location");r&&r.scrollIntoView()},ue=({setState:e,component:n})=>t=>{const{toggleFloorPlanInteractive:o}=n;e({marker:t,view:"floorPlan"}),o("none"!==t)},fe=({state:e,setState:n,component:t})=>o=>{const{templateCache:a}=t,r=o??!e.floorPlanInteractive,{floorPlan:i}=e,{floorPlanImage:l}=a,s=r?"add":"remove";l.classList[s]("pg-floor-plan-image--interactive"),i.clickableAreas.length>0&&(r?l.setAttribute("usemap","#floorPlan"):l.removeAttribute("usemap")),n({floorPlanInteractive:r})},ve=({state:e,component:n})=>({target:t})=>{const{root:o}=n;if("nowOnly"===e.sortBy)return;if(!o.querySelector(".pg-table-wrapper").classList.contains("pg-table-wrapper--scrolled"))return;const a=o.querySelectorAll(".pg-cell-wrapper--row-header"),r="pg-cell-wrapper--row-header-collapsed",i=t.classList.contains(r)?"remove":"add";for(const e of a)e.classList[i](r);o.querySelector(".pg-cell-wrapper--corner").classList[i]("pg-cell-wrapper--corner-collapsed")},be=({state:e,component:n})=>t=>{const{root:o,dataset:a}=n,r="true"===t||!!t,i=o.querySelector(".pg-dialog--sort"),l=w(B(e,a.breakpoint));b(i),i.appendChild(l),r?i.showModal():i.close()},we=({setState:e,component:n})=>t=>{const{root:o}=n,a=decodeURIComponent(t),r=JSON.parse(a),i=e({activeEvent:j(r)},{render:!1}),l=o.querySelector(".pg-dialog--event"),s=w(R(i));b(l),l.appendChild(s),l.open||l.showModal()},ye=({component:e})=>()=>{const{root:n}=e;n.querySelector(".pg-dialog--event").close()},ke=({setState:e,component:n})=>t=>{const{toggleSortDialog:o}=n;o(!1),e({view:"guide",sortBy:"location",activeLocation:t})},$e=({state:e,setState:n})=>t=>{const o=t.target.value,a=e.activeTime.toLocaleTimeString();n({activeDay:o,activeTime:new Date(`${o} ${a}`)},{render:!1})},Se=({state:e,setState:n})=>({target:t})=>{t.min>t.value&&(t.value=t.min),t.max<t.value&&(t.value=t.max);const{interval:o}=e.times||c,[a,r]=t.value.split(":"),i=Math.round(r/o)*o,l=1===String(i).length?`0${i}`:i;t.value=`${a}:${l}`;const{activeDay:s}=e,d=t.value;n({activeTime:new Date(`${s} ${d}`)},{render:!1})},xe=({setState:e,component:n})=>t=>{const{toggleSortDialog:o}=n;o(!1),e({view:"guide",marker:"none",sortBy:t})},De=({setState:e})=>({target:n})=>{e({currentSearch:n.value},{render:!1})},_e=({state:e,setState:n})=>t=>{t.preventDefault();const{currentSearch:o,events:a}=e,r=a.filter((e=>E(o,e.name)||E(o,e.location)||E(o,e.host)||E(o,e.category)||E(o,e.description))).sort(((e,n)=>{const t=E(o,e.name),a=E(o,n.name);return!t&&a?1:t&&!a?-1:0}));n({searchResults:r,sortBy:"search"})};class Ee extends HTMLElement{#e={locations:[],events:[],times:c,activeDay:"",activeTime:new Date,activeLocation:"",activeEvent:j(l),sortBy:"location",view:"guide",marker:"none",favorites:[],currentSearch:"",searchResults:[],floorPlan:{},floorPlanInteractive:!1};templateCache={floorPlanImage:new Image};constructor(){super();const e=this;e.root=e.attachShadow({mode:"open"});const n={render:de,handleEsc:me,handleHashChange:he,addFavorite:pe,removeFavorite:ge,showFloorPlan:ue,toggleFloorPlanInteractive:fe,toggleHeaders:ve,toggleSortDialog:be,openEventDialog:we,closeEventDialog:ye,selectActiveLocation:ke,selectActiveDay:$e,selectActiveTime:Se,selectSortBy:xe,changeSearch:De,search:_e};for(const t in n){const o=n[t];e[t]=e.provideState(o)}e.render({loading:!0}),e.waitForFetch=L().then((async n=>{const t={events:await M(),times:await N(),favorites:await C(),floorPlan:await O(),locations:n},{floorPlanImage:o}=e.templateCache,{imageSrc:a,dimensions:r}=t.floorPlan,{height:i,width:l}=r;o.className="pg-floor-plan-image",o.src=a,o.height=i,o.width=l;const{days:s}=t.times||c,d=Object.keys(s)[0],p=s[d][0].date,{date:g,time:m}=x(p);e.setState({...t,activeLocation:n[0],activeDay:d,activeTime:new Date(`${g} ${m}`)})}))}connectedCallback(){const e=this;window.addEventListener("keydown",e.handleEsc),e.waitForFetch.then((()=>{window.addEventListener("hashchange",e.handleHashChange)}))}disconnectedCallback(){window.removeEventListener("keydown",this.handleEsc),window.removeEventListener("hashchange",this.handleHashChange)}setState(e,n={render:!0}){const t=this;return t.#e={...t.#e,...e},n.render&&t.render(),{...t.#e}}provideState(e){const n=this;return(...t)=>{const o={...n.#e},a=n.setState.bind(n);return e({state:o,setState:a,component:n})(...t)}}}return{...I,Components:Object.freeze({__proto__:null,ProgramGuideNative:Ee})}}));